<!-- (C) 2015 Rozum Halina, BSUIR -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>

<HEAD>
    <LINK rel=stylesheet href="../../Оболочка/css/style.css" type=text/css>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html" charset="utf8">
    <META HTTP-EQUIV="Content-Language" CONTENT="ru">
    <title> Практика по дисциплине &quot;Операционные системы, базы данных&quot;</title>
    <base target="_top">
</HEAD>

<BODY>
    <table width="100%" border="0" cellpadding="0" cellspacing="3" background="../../Оболочка/images/background.jpg">
        <tr>
            <td width="13%" rowspan=3 align="center"><img src="../../Оболочка/images/logo_new.jpg" width=117 align="middle">
            </td>
            <tr>
                <td width="70%" colspan=2 align="center" valign="middle">
                    <H1 align="center">электронный
        ресурс по учебной дисциплине<BR>
        &quot;Операционные системы, базы данных&quot;<BR>
        для специальности: </H1> 1-58 01 01 - &quot;ИНЖЕНЕРНО-ПСИХОЛОГИЧЕСКОЕ ОБЕСПЕЧЕНИЕ ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ&quot;.
                </td>
                <td width="12%" rowspan=3 align="center">&nbsp;</td>
  <Tr>
    <td align=center colspan=2><var class="normal">
                                                  <A HREF="../../index.htm">Оглавление</A> |
                                                  <A HREF="../../Программа/program.html" TITLE="Программа курса (Откроется в новом окне)">Программа</A> |
                                                  <A HREF="../../Теория/theory.htm">Теория</A> |
                                                  <strong>Практика</strong>|
                                                  <A HREF="../../Контроль_знаний/test.htm">Контроль знаний</A> |
                                                  <A HREF="../../Об авторах/author.htm">Об авторах</A>
     </var></var> </td>
  </tr>
    </table>
    <P class="margined">
        <FONT SIZE=4>
            <CENTER>
            </CENTER>
        </FONT>
        <table style="margin:0 auto;" width="90%" border="0" cellpadding="0" cellspacing="0">
            <td>
 <A HREF="../practice.htm">Оглавление</A>
                <p>&nbsp;</p>
                 <div> <p><b><span>Лабораторная работа 2 Создание таблиц и формирование запросов в СУРБД ORACLE</span></b><span><o:p></o:p></span></p> 
<p><b><span>1. Цель работы<o:p></o:p></span></b></p> <p><span>Создание таблиц и формирование запросов в СУРБД </span><span>ORACLE</span><span>.<i><o:p></o:p></i></span></p> <p><b><span>2. Учебный материал по <span>лабораторной</span></span></b><span><o:p></o:p></span></p> <p><span>Создание Таблиц <o:p></o:p></span></p> <p><span>При построении запроса из двух таблиц, где столбцы имеют одинаковые имена, то применяется «точечная нотация», т.е. запись вида: <span><span>имя_таблицы<span>.и</span>мя_столбца</span></span> <o:p></o:p></span></p> <p><span>(Аналогично разные схемы БД (то есть пользователи) также могут содержать таблицы с одинаковыми именами, но в разных схемах).<o:p></o:p></span></p> <p><span>Построение сложных запросов <o:p></o:p></span></p> <p><span>Синтаксис оператора </span><span>SELECT</span><span> имеет следующий вид:<o:p></o:p></span></p> <p><span>SELECT ([ALL | DISTINCT] < </span><span>список</span><span> </span><span>полей</span><span>>|*)<o:p></o:p></span></p> <p><span>FROM</span><span><span> </span><Список таблиц><o:p></o:p></span></p> <p><span>[</span><span>WHERE</span><span><span> </span> <Предикат-условие выборки или соединения>]<o:p></o:p></span></p> <p><span>[</span><span>GROUP</span><span> </span><span>BY</span><span> <Список полей результатам]<o:p></o:p></span></p> <p><span>[</span><span>HAVING</span><span> </span><span><Предикат-условие для группы>]<o:p></o:p></span></p> <p><span>[</span><span>ORDER</span><span> </span><span>BY</span><span> </span><span><Список полей, по которым упорядочить вывод>]<o:p></o:p></span></p> <p><span>При отображении информации на экран ПОЛЕЗНО использовать оператор форматирования столбца:<o:p></o:p></span></p> <p><span>COL </span><span>имя</span><span>_</span><span>столбца</span><span> FORMAT Ann</span><span>, </span><span>например</span><span>: <span>COL FIO FORMAT A10</span><o:p></o:p></span></p> <p><span>При работе с типом </span><span>DATE</span><span> можно использовать встроенную функцию </span><span>TO</span><span>_</span><span>DATE</span><span> </span><span>например,<o:p></o:p></span></p> <pre><span>SELECT</span><span> <span>имя_столбца</span> </span><span>FROM</span><span> <span>имя_таблицы</span><o:p></o:p></span></pre><pre><span>WHERE HIRE_DATE < TO_DATE ('01.06.1988','DD/MM/YYYY')<o:p></o:p></span></pre> <p><span><o:p> </o:p></span></p> <p><span>Пример 1:<o:p></o:p></span></p> <p><span>Выбрать все записи из таблицы Закупка детали:<o:p></o:p></span></p> <p><span><span>select</span></span><span> KODDZ, KODZ, KOLVO, PRICED, DATA from <span>zakupkad</span>;<o:p></o:p></span></p> <p><span>Пример 2:<o:p></o:p></span></p> <p><span>Выбрать данные из полей «Название завода», «Адрес» и «ФИО руководителя» по заводу с кодом 2:<o:p></o:p></span></p> <p><span><span>select</span></span><span> NAMEZ, ADRESS, FIOR<span> </span>from <span>zavod</span><span> </span>where <span>kodz</span>=2;<o:p></o:p></span></p> <p><span><span> </span><o:p></o:p></span></p> <p><span>Условия.<o:p></o:p></span></p> <p><span>Условия в предложении </span><span>where</span><span> может быть несколько. В таком случае используют ключевые слова:<o:p></o:p></span></p> <p><span>And <span>-<span> </span><span>И</span></span><o:p></o:p></span></p> <p><span>Or - </span><span>ИЛИ</span><span><o:p></o:p></span></p> <p><span>Like – </span><span>КАК</span><span><o:p></o:p></span></p> <p><span>BETWEEN<o:p></o:p></span></p> <p><span>IN</span><span> - выборка значений из списка<o:p></o:p></span></p> <p><span>IS</span><span> </span><span>Null</span><span> | </span><span>IS</span><span> </span><span>NOT</span><span> </span><span>NULL</span><span><o:p></o:p></span></p> <p><span>Пример 3:<o:p></o:p></span></p> <p><span>Выбрать из таблицы Закупка деталей информацию по деталям, купленным у завода с кодом 2, подставив вместо кода название:<o:p></o:p></span></p> <p><span><span> </span></span><span><span>select</span></span><span> </span><span><span>zavod</span></span><span>.</span><span><span>kodz</span></span><span>, </span><span><span>zavod</span></span><span>.</span><span><span>namez</span></span><span>,<span> </span></span><span><span>zakupkad</span></span><span>.</span><span><span>koddz</span></span><span>,<span> </span></span><span><span>zakupkad</span></span><span>.</span><span><span>kolvo</span></span><span>, </span><span>priced</span><span>, </span><span>data</span><span><o:p></o:p></span></p> <p><span><span> </span></span><span><span>from</span></span><span> <span>zakupkad</span>, </span><span><span>zavod</span></span><span><o:p></o:p></span></p> <p><span><span> </span></span><span><span>where</span></span><span> </span><span><span>zavod</span></span><span>.</span><span><span>kodz</span></span><span>=</span><span><span>zakupkad</span></span><span>.</span><span><span>kodz</span></span><span> </span><span>and</span><span> </span><span><span>zavod</span></span><span>.</span><span><span>kodz</span></span><span>=2;<o:p></o:p></span></p> <p><span><span> </span></span><span>KODDZ<span> </span>KODZ<span> </span>KOLVO PRICED<span> </span>DATA <o:p></o:p></span></p> <p><span><span> </span>----------<span> </span>----------------------------<span> </span>----------<span> </span>----------<span> </span>--------<o:p></o:p></span></p> <p><span><span> </span></span><span>31<span> </span>Лакокрасочный завод<span> </span>8<span> </span>30<span> </span>07.01.07 <o:p></o:p></span></p> <p><span><span> </span>32<span> </span>Лакокрасочный завод<span> </span>1<span> </span>35<span> </span>10.01.07 <o:p></o:p></span></p> <p><span>Пример 4:<o:p></o:p></span></p> <p><span>Закупались ли детали у заводов с кодом 2 и 3?<o:p></o:p></span></p> <p><span><span>select</span></span><span> *<span> </span>from <span>zavod</span><span> </span>where <span>kodz</span>=2 and <span>kodz</span>=3;<o:p></o:p></span></p> <p><span>Пример 5:<o:p></o:p></span></p> <p><span>Закупались ли детали у заводов с кодом 2 или 3?<o:p></o:p></span></p> <p><span><span>select</span></span><span> *<span> </span>from <span>zavod</span><span> </span>where <span>kodz</span>=2 or <span>kodz</span>=3;<o:p></o:p></span></p> <p><span>Пример 6:<o:p></o:p></span></p> <p><span>Есть ли в таблице завод, в названии которого присутствует слово «лак»?<o:p></o:p></span></p> <p><span><span>select</span></span><span> *<span> </span>from <span>zavod</span><span> </span>where <span>namez</span> like ‘%</span><span>лак</span><span>%’ or <span>namez</span> like ‘%</span><span>Лак</span><span>%’;<o:p></o:p></span></p> <p><span>Пример 7:<o:p></o:p></span></p> <p><span>Выбрать информацию по деталям, которые закупались в одну из дат:<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><span> </span><o:p></o:p></span></p> <p><span><span>where</span></span><span> data in (’07-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’10-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’11-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>);<o:p></o:p></span></p> <p><span>Пример 8:<o:p></o:p></span></p> <p><span>Выбрать информацию по деталям, которые закупались между датами:<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><o:p></o:p></span></p> <p><span><span>where</span></span><span> data between ’07-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter> and ’11-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>;<o:p></o:p></span></p> <p><span>Пример 9:<o:p></o:p></span></p> <p><span>Выбрать информацию по заводам, у которых поле «телефон» пустое:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>kodz</span><span> </span>from <span>zavod</span><span> </span>where <span>telz</span> is null;<o:p></o:p></span></p> <p><span>Пример 10:<o:p></o:p></span></p> <p><span>Выбрать информацию по заводам, у которых поле «телефон» заполнено:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>kodz</span><span> </span>from <span>zavod</span><span> </span>where <span>telz</span> is not null;<o:p></o:p></span></p> <p style="text-align: center;"><span>Синонимы и их применение при выборке данных.<o:p></o:p></span></p> <p><span>Синонимы представляют собой альтернативное имя объекта, определяемое пользователем и служащее для более удобного использования при работе с именами объектов.<o:p></o:p></span></p> <p><span><span>create</span></span><span> [</span><span>public</span><span>] </span><span>synonym</span><span> </span><span><span>имя_синонима</span></span><span> </span><span>for</span><span> </span><span><span>имя_польз.имя_объекта</span></span><span>;<o:p></o:p></span></p> <p><span>(</span><span>public</span><span> означает, что данный синоним может использоваться любым пользователем.)<o:p></o:p></span></p> <p><span>Пример 11:<o:p></o:p></span></p> <p><span>Запрос, приведенный в примере № 3 можно записать короче:<o:p></o:p></span></p> <p><span><span> </span></span><span><span>select</span></span><span> <span>b.kodz</span>, <span>b.namez</span>,<span> </span><span>a.koddz</span>,<span> </span><span>a.kolvo</span>, a, data<o:p></o:p></span></p> <p><span><span> </span><span>from</span> <span>ZakupkaD</span> a , <span>Zavod</span> b<o:p></o:p></span></p> <p><span><span> </span><span>where</span> <span>b.kodz</span>=<span>a.kodz</span> and <span>b.kodz</span>=2;<o:p></o:p></span></p> <p><span>Пример 12:<o:p></o:p></span></p> <p><span>Создать синоним для таблицы Закупка деталей для пользователя студент:<o:p></o:p></span></p> <p><span><span>create</span></span><span> synonym <span>zakd</span><span> </span>for <span>student.Zakupkad</span>;<o:p></o:p></span></p> <p style="text-align: center;"><span>Подзапросы.<o:p></o:p></span></p> <p><span>Запросы, в которых используются несколько предложений </span><span>select</span><span>.<o:p></o:p></span></p> <p><span>Могут быть однострочные (возвращают одну строку: в условии используются знаки равенства/ неравенства) и многострочные (подзапрос возвращает несколько строк: используется <span>in</span>)<o:p></o:p></span></p> <p><span>Пример 13:<o:p></o:p></span></p> <p><span>Выбрать детали, которые покупались у заводов, в названии которых есть слово «лак»<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><o:p></o:p></span></p> <p><span><span>where</span></span><span> <span>kodz</span> in<span> </span><o:p></o:p></span></p> <p><span><span> </span>(<span>select</span> <span>kodz</span><o:p></o:p></span></p> <p><span><span> </span><span>from</span> <span>zavod</span><o:p></o:p></span></p> <p><span><span> </span><span>where</span> <span>namez</span> like ‘%</span><span>лак</span><span>%’ or <span>namez</span> like ‘%</span><span>Лак</span><span>%’ );<o:p></o:p></span></p> <p style="text-align: center;"><span>Представления<o:p></o:p></span></p> <p><span>Пример 1. Сортировка:<o:p></o:p></span></p> <p><span><span> </span>Выбрать все записи из таблицы Закупка деталей и отсортировать по коду детали:<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><span> </span>order by <span>koddz</span>; <o:p></o:p></span></p> <p><span>KODDZ KODZ KOLVO PRICED DATA<span> </span><o:p></o:p></span></p> <p><span>---------- ---------- ---------- ---------- ------------<o:p></o:p></span></p> <p><span><span> </span></span><span>31<span> </span>2<span> </span><span> </span>8<span> </span>30<span> </span>07.01.06 <o:p></o:p></span></p> <p><span><span> </span>31<span> </span>2<span> </span>8<span> </span>30<span> </span>12.02.06 <o:p></o:p></span></p> <p><span><span> </span>32<span> </span>2<span> </span>1<span> </span>35<span> </span>10.01.06 <o:p></o:p></span></p> <p><span><span> </span>32<span> </span>2<span> </span>1<span> </span>35<span> </span>15.02.06 <o:p></o:p></span></p> <p><span><span> </span>41<span> </span>4<span> </span>4<span> </span><span> </span>48<span> </span>11.01.06 <o:p></o:p></span></p> <p><span><span> </span>41<span> </span>4<span> </span>4<span> </span>48<span> </span>16.03.05 <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Возрастание (ASC) или убывание (DESC) для каждого столбца. По умолчанию установлено – возрастание<o:p></o:p></span></p> <p><span><span> </span></span><span>SELECT</span><span> * </span><span>FROM</span><span> </span><span>Orders</span><span><span> </span></span><span>ORDER</span><span> </span><span>BY</span><span> </span><span><span>cnum</span></span><span> </span><span>DESC</span><span>;<o:p></o:p></span></p> <p><span>Пример 2. Группировка:<o:p></o:p></span></p> <p><span>Посчитать сколько раз покупали ту или иную деталь:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>koddz</span>, count(data)<o:p></o:p></span></p> <p><span><span>from</span></span><span> <span>zakupkad</span><o:p></o:p></span></p> <p><span><span>group</span></span><span> by <span>koddz</span>;<o:p></o:p></span></p> <p><span>KODDZ COUNT (DATA)<o:p></o:p></span></p> <p><span>---------- -----------<o:p></o:p></span></p> <p><span><span> </span>31<span> </span>2<o:p></o:p></span></p> <p><span><span> </span>32<span> </span>2<o:p></o:p></span></p> <p><span><span> </span>41<span> </span>2<o:p></o:p></span></p> <p><span>ЗАМЕЧАНИЕ: в предложении </span><span>group</span><span> </span><span>by</span><span> указывается поле, которое обязательно должно присутствовать в предложении </span><span>select</span><span>, в отличие от предложения <span>order</span> </span><span>by</span><span>. Также, в предложении </span><span>group</span><span> </span><span>by</span><span> можно указывать несколько полей, в этом случае группировка будет последовательна сначала по одному полю, потом по второму.<o:p></o:p></span></p> <p><span>Пример 4. Конкатенация (<span>объединеие</span>):<o:p></o:p></span></p> <p><span>ЗАМЕЧАНИЕ: в предложениях </span><span>select</span><span> можно объединять значения двух или более полей (например, если ФИО разбито на 3 поля) и добавлять сторонний текст.<o:p></o:p></span></p> <p><span>Вывести данные из примера №2, используя возможности конкатенации:<o:p></o:p></span></p> <p><span><span> </span><span>select</span> '<span>Деталь'||</span>' '<span>||koddz||</span>' '<span>||'покупалась'||</span>' '<span>||count</span>(<span>data</span>)<span>||'ра<span>з</span></span><span>(</span>-а)'<o:p></o:p></span></p> <p><span><span>from</span></span><span> <span>zakupkad</span><o:p></o:p></span></p> <p><span><span>group</span></span><span> by <span>koddz</span>;<o:p></o:p></span></p> <p><span>'</span><span>ДЕТАЛЬ</span><span>'||''||KODDZ||''||'</span><span>ПОКУПАЛАСЬ</span><span>'||''||<span>COUNT(</span>DATA)||'</span><span>РАЗ</span><span>(-</span><span>А</span><span>)<o:p></o:p></span></p> <p><span>----------------------------------------------------------------<o:p></o:p></span></p> <p><span>Деталь 31 покупалась 2раз(-а)<o:p></o:p></span></p> <p><span>Деталь 32 покупалась 2раз(-а)<o:p></o:p></span></p> <p><span>Деталь 41 покупалась 2раз(-а)<o:p></o:p></span></p> <p><span>Пример 5. Синонимы столбцов, ввод собственного текста:<o:p></o:p></span></p> <p><span>При выполнении запросов в примерах 2-4, в качестве имени поля выводиться то, что пишется в предложениях </span><span>select</span><span>. Вид результата можно привести в более удобный для пользователя вид с помощью синонимов столбцов.<o:p></o:p></span></p> <p><span>Синонимы пишутся через пробел. Если синоним состоит из нескольких слов, то они отделяются символом нижнего подчеркивания, например, <span>Название_завода</span>.<o:p></o:p></span></p> <p><span><span>select</span></span><span> </span><span><span>kodz</span></span><span> Код, </span><span><span>namez</span></span><span> Название<span> </span></span><span>from</span><span> </span><span><span>zavod</span></span><span>;<o:p></o:p></span></p> <p><span><span> </span>КОД<span> </span>НАЗВАНИЕ<o:p></o:p></span></p> <p><span>-----<span> </span>----------------------------------------<o:p></o:p></span></p> <p><span><span> </span>1<span> </span>Стекольный завод №1<o:p></o:p></span></p> <p><span><span> </span>2<span> </span>Лакокрасочный завод<o:p></o:p></span></p> <p><span><span> </span>4<span> </span><span>Деревообработывающий</span> завод № 5<o:p></o:p></span></p> <p><span><span> </span>5<span> </span>Завод по изготовлению металлоконструкций<o:p></o:p></span></p> <p><span>На базе примера № 3:<o:p></o:p></span></p> <p><span><span>select</span></span><span> Sum((KOLVO)*(PRICED)) </span><span>Сумма</span><span><o:p></o:p></span></p> <p><span><span>from</span></span><span> <span>zakupkad</span><span> </span>where <span>koddz</span>=31;<o:p></o:p></span></p> <p><span><span> </span></span><span>СУММА<o:p></o:p></span></p> <p><span>----------<o:p></o:p></span></p> <p><span><span> </span>480<o:p></o:p></span></p> <p><span>Пример 6. Выборка неповторяющихся (уникальных) записей:<o:p></o:p></span></p> <p><span>Добавим в таблицу Закупка деталей дублирующую строку со значениями <o:p></o:p></span></p> <p><span>KODDZ KODZ KOLVO PRICED DATA<span> </span><o:p></o:p></span></p> <p><span>---------- ---------- ---------- ---------- ------------<o:p></o:p></span></p> <p><span><span> </span></span><span>41<span> </span>4<span> </span>4<span> </span>48<span> </span>11.01.06 <o:p></o:p></span></p> <p><span>Сделать выборку данных из всех полей таблицы Закупка деталей, исключая повторяющиеся записи:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>distinct</span> * <span>from</span> <span>zakupkad</span>;<o:p></o:p></span></p> <p><span>Таким образом <span>дублирующяся</span> запись пропущена, выведено 6 строк.<o:p></o:p></span></p> <p><span>Пример 7. Применение </span><span>NOT</span><span>:<o:p></o:p></span></p> <p><span>Выбрать информацию по заводам, у которых поле «телефон» не пустое:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>kodz</span><span> </span>from <span>zavod</span><span> </span>where <span>telz</span> is not null;<o:p></o:p></span></p> <p><span>АНАЛОГИЧНО</span><span>:<o:p></o:p></span></p> <p><span><span>select</span></span><span> <span>kodz</span><span> </span>from <span>zavod</span><span> </span>where not <span>telz</span> is null;<o:p></o:p></span></p> <p><span>Выбрать информацию по деталям, которые закупались в одну из дат:<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><span> </span>where data not in (’07-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’10-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’11-01-07’);<o:p></o:p></span></p> <p><span>АНАЛОГИЧНО</span><span>:<o:p></o:p></span></p> <p><span><span>select</span></span><span> * from <span>zakupkad</span><span> </span>where not<span> </span>data in (’07-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’10-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>, ’11-01-<st1:metricconverter productid="07’" w:st="on">07’</st1:metricconverter>);<o:p></o:p></span></p> <p><span>Пример 8. Применение агрегатных функций:<o:p></o:p></span></p> <p><span>* </span><span>COUNT</span><span> - считает число значений в данном столбце, или число строк в таблице (</span><span>count</span><span> (*), например). Когда она считает значения столбца, она используется с DISTINCT чтобы производить счет чисел различных значений в данном поле.<span> </span>Если вместо DISTINCT указать |</span><span>ALL</span><span>, то в результате будет выведено число строк, в которых указанное поле не нулевое.<o:p></o:p></span></p> <p><span>SQL> select * from u;<o:p></o:p></span></p> <p><span><span> </span>I<span> </span>L<span> </span>P<span> </span>N<o:p></o:p></span></p> <p><span>---------- --------------- --------------- ---------------<o:p></o:p></span></p> <p><span><span> </span>1<span> </span></span><span>b</span><span><span> </span>1<span> </span>Бухгалтер<o:p></o:p></span></p> <p><span><span> </span>2<span> </span></span><span>p</span><span><span> </span>2<span> </span>Плановик<o:p></o:p></span></p> <p><span><span> </span>3<span> </span></span><span>m</span><span><span> </span>3<span> </span>Менеджер<o:p></o:p></span></p> <p><span><span> </span></span><span>4<span> </span><span> </span>4<span> </span></span><span>Гость</span><span><o:p></o:p></span></p> <p><span>SQL> select <span>count(</span>l)<o:p></o:p></span></p> <p><span><span> </span>2 from u;<o:p></o:p></span></p> <p><span><span> </span>COUNT (L)<o:p></o:p></span></p> <p><span>----------<o:p></o:p></span></p> <p><span><span> </span>3<o:p></o:p></span></p> <p><span>SQL> select count (*)<o:p></o:p></span></p> <p><span><span> </span></span><span>2 </span><span>from</span><span> </span><span>u</span><span>;<o:p></o:p></span></p> <p><span><span> </span>COUNT(*)<o:p></o:p></span></p> <p><span>----------<o:p></o:p></span></p> <p><span><span> </span>4<o:p></o:p></span></p> <p><span>* </span><span>SUM</span><span> – арифметическая сумма всех выбранных значений данного поля. <o:p></o:p></span></p> <p><span>* </span><span>AVG</span><span> – усредненное значение всех выбранных значений данного поля. <o:p></o:p></span></p> <p><span>* </span><span>MAX</span><span> - наибольшее из всех выбранных значений данного поля. <o:p></o:p></span></p> <p><span>* </span><span>MIN</span><span> - производит наименьшее из всех выбранных значений данного поля.<o:p></o:p></span></p> <p><span>Только числовые поля могут использоваться с SUM и AVG. <o:p></o:p></span></p> <p><span>С COUNT, MAX, и MIN, могут использоваться и числовые или символьные поля. Когда они используются с символьными полями, MAX и MIN будут транслировать их в эквивалент ASCII, который должен сообщать, что MIN будет означать первое, а MAX последнее значение в алфавитном порядке<o:p></o:p></span></p> <p><span>ПРИМЕР:<o:p></o:p></span></p> <p><span>Посчитать на какую сумму куплены детали с кодом 31 за все время:<o:p></o:p></span></p> <p><span><span>select</span></span><span> Sum((KOLVO)*(PRICED))<o:p></o:p></span></p> <p><span><span>from</span></span><span> <span>zakupkad</span><span> </span>where <span>koddz</span>=31;<o:p></o:p></span></p> <p><span><span> </span><span>SUM<span>(</span></span></span><span>(</span><span>KOLVO</span><span>)*(</span><span>PRICED</span><span>))<o:p></o:p></span></p> <p><span>---------------------<o:p></o:p></span></p> <p><span><span> </span>480<span> </span><o:p></o:p></span></p> <p><span>Использование скалярных выражений:<o:p></o:p></span></p> <p><span>SELECT MAX (<span>blnc</span> + (amt))<span> </span>FROM Orders;<o:p></o:p></span></p> <p><span>Пример 9. </span><span>Having</span><span>:<o:p></o:p></span></p> <p><span>Нельзя использовать агрегатную функцию в предложении WHERE (если вы не используется подзапрос), потому что предикаты оцениваются в терминах одиночной строки, а агрегатные функции оцениваются в терминах групп строк. Это означает, что нельзя сделать что-нибудь подобно следующему: <o:p></o:p></span></p> <p><span><span> </span></span><span>SELECT</span><span> </span><span><span>snum</span></span><span>, </span><span><span>odate</span></span><span>, </span><span>MAX</span><span> (</span><span>amt</span><span>) <o:p></o:p></span></p> <p><span><span> </span></span><span>FROM <span>Oreders</span> <o:p></o:p></span></p> <p><span><span> </span>WHERE MAX ((amt)) > 3000.00 <o:p></o:p></span></p> <p><span><span> </span>GROUP</span><span> </span><span>BY</span><span> </span><span><span>snum</span></span><span>, </span><span><span>odate</span></span><span>; <o:p></o:p></span></p> <p><span>Это будет отклонением от строгой интерпретации ANSI. Чтобы увидеть максимальную стоимость приобретений свыше $3000.00, вы можете использовать предложение HAVING. Предложение HAVING определяет критерии используемые чтобы удалять определенные группы из вывода, точно также как предложение WHERE делает это для индивидуальных строк. Правильной командой будет следующая: <o:p></o:p></span></p> <p><span><span> </span></span><span>SELECT</span><span> </span><span><span>snum</span></span><span>, </span><span><span>odate</span></span><span>, </span><span>MAX</span><span> ((</span><span>amt</span><span>)) <o:p></o:p></span></p> <p><span><span> </span>FROM <span>Orders</span> <o:p></o:p></span></p> <p><span><span> </span></span><span>GROUP BY <span>snum</span>, <span>odate</span> <o:p></o:p></span></p> <p><span><span> </span>HAVING MAX ((amt)) > 3000.00;<o:p></o:p></span></p> <p style="text-align: center;"><span>Создание</span><span> </span><span>представлений</span><span>.<o:p></o:p></span></p> <p><span>Представление (</span><span>view</span><span>) – это один из объектов БД, представляющий собой хранимый запрос, с которым можно работать, как с таблицей, т.е. добавлять, редактировать, удалять данные. Это удобно, т.к. чаще всего используются данные многих таблиц. Обычно сначала создаются представления, а потом на их основе выводятся данные для пользователя в клиентском приложении. В таком случае, пользователю можно дать полный доступ на какое-то представление, не давая доступа на таблицу.<o:p></o:p></span></p> <p><span>Общий синтаксис:<o:p></o:p></span></p> <p><span><span>create</span></span><span> </span><span>view</span><span><span> </span><span>имя_представления</span><o:p></o:p></span></p> <p><span><span>as</span></span><span><o:p></o:p></span></p> <p><span>текст<o:p></o:p></span></p> <p><span>[</span><span><span>атрибуты</span></span><span>]<o:p></o:p></span></p> <p><span>Пример</span><span>:<o:p></o:p></span></p> <p><span>CREATE VIEW US AS <o:p></o:p></span></p> <p><span><span> </span><span>select</span> l , p<o:p></o:p></span></p> <p><span><span> </span><span>from</span> u<span> </span>WITH READ ONLY;<o:p></o:p></span></p> <p><span>Выборка:<o:p></o:p></span></p> <p><span>Select</span><span> * </span><span>from</span><span> </span><span>us</span><span>;<o:p></o:p></span></p> <p><b><span>3. Порядок выполнения работы<o:p></o:p></span></b></p> <p><![if !supportLists]><span><span>1.<span> </span></span></span><![endif]><span>Ознакомиться с учебным материалом<o:p></o:p></span></p> <p><![if !supportLists]><span><span>2.<span> </span></span></span><![endif]><span>В </span><span>IDE</span><span> </span><span>Eclipse</span><span> создать проект.<o:p></o:p></span></p> <p><![if !supportLists]><span><span>3<span> </span></span></span><![endif]><span>Построить таблицы, заполнить их информацией, сформировать по 2 запроса следующих типов:<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>выборка всех данных<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>запрос с условием<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>запрос с использованием синонимов<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием подзапроса<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием сортировки<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием группировки<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием конкатенации<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>выборка неповторяющихся записей<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием агрегатных функций<o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием </span><span>NOT</span><span><o:p></o:p></span></p> <p><![if !supportLists]><span><span>-<span> </span></span></span><![endif]><span>с использованием </span><span>WHERE</span><span><o:p></o:p></span></p> <p><span>Запросы сохранить в виде представлений.<o:p></o:p></span></p> <p><![if !supportLists]><span><span>4<span> </span></span></span><![endif]><span>Продемонстрировать результат работы преподавателю.</span><span><o:p></o:p></span></p> <p><![if !supportLists]><span><span>5<span> </span></span></span><![endif]><span>Согласовать с преподавателем содержание отчёта и подготовить его.</span><span><o:p></o:p></span></p> <p><a></a><o:p> </o:p></p> </div> 
 <A HREF="../practice.htm">Оглавление</A>             
   <p>&nbsp;</p>
        </table>
<table width="100%" height=25px border="0" cellpadding="0" cellspacing="3" bordercolor="#316AC5" background="../Оболочка/images/background.jpg">
  <tr >
  <td align=center><var><B><b>(С)  БГУИР</b></var></td>
  </tr>
</table>
</BODY></HTML>