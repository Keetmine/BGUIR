<!-- (C) 2015 Rozum Halina, BSUIR -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>

<HEAD>
    <LINK rel=stylesheet href="../../Оболочка/css/style.css" type=text/css>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html" charset="utf8">
    <META HTTP-EQUIV="Content-Language" CONTENT="ru">
    <title> Теория по дисциплине &quot;Операционные системы, базы данных&quot;</title>
    <base target="_top">
</HEAD>

<BODY>
    <table width="100%" border="0" cellpadding="0" cellspacing="3" background="../../Оболочка/images/background.jpg">
        <tr>
            <td width="13%" rowspan=3 align="center"><img src="../../Оболочка/images/logo_new.jpg" width=117 align="middle">
            </td>
            <tr>
                <td width="70%" colspan=2 align="center" valign="middle">
                    <H1 align="center">электронный
        ресурс по учебной дисциплине<BR>
        &quot;Операционные системы, базы данных&quot;<BR>
        для специальности: </H1> 1-58 01 01 - &quot;ИНЖЕНЕРНО-ПСИХОЛОГИЧЕСКОЕ ОБЕСПЕЧЕНИЕ ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ&quot;.
                </td>
                <td width="12%" rowspan=3 align="center">&nbsp;</td>
  <Tr>
    <td align=center colspan=2><var class="normal">
                                                  <A HREF="../../index.htm">Оглавление</A> |
                                                  <A HREF="../../Программа/program.html" >Программа</A> | 
                                                    <strong>Теория</strong>|
                                                  <A HREF="../../Практика/practice.htm">Практика</A>|
                                                  <A HREF="../../Контроль_знаний/test.htm">Контроль знаний</A> |
                                                  <A HREF="../../Об авторах/author.htm">Об авторах</A>
     </var></var> </td>
  </tr>
    </table>
    <P class="margined">
        <FONT SIZE=4>
            <CENTER>
            </CENTER>
        </FONT>
<table style="margin:0 auto;" width="90%" border="0" cellpadding="0" cellspacing="0">
            <td>
 <A HREF="../theory.htm">Оглавление</A>
                <p>&nbsp;</p>
                 <div> <p style="text-align: center;"><b><span>Тема 12. Проектирование реляционной базы данных<o:p></o:p></span></b></p> <p><a><b><span>12.1. Элементы реляционной модели и формы их представление</span></b></a><b><span><o:p></o:p></span></b></p> <p><span>Реляционная модель данных (РМД) некоторой предметной области представляет собой набор отношений, изменяющихся во времени. При создании информационной системы совокупность отношений позволяет хранить данные об объектах предметной области и моделировать связи между ними. Элементы РМД и формы их представления приведены в табл. </span><span>4</span><span>.1.<o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица </span><span>4</span><span>.1<o:p></o:p></span></p> <p style="text-align: center;"><span>Элементы реляционной модели<o:p></o:p></span></p> <table border="1" cellspacing="0" cellpadding="0" width="626" style="margin:0 auto;"> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Элемент реляционной модели<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Форма представлений<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Отношение<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Таблица<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Схема отношения<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>C</span><span>трока заголовков столбцов таблицы<span> </span>(заголовок таблицы)<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Кортеж<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Строка таблицы<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Сущность<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Описание свойств объекта<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Атрибут<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Заголовок столбца таблицы<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Домен<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Множество допустимых значений атрибута<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Значение атрибута<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Значение поля в записи<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Первичный ключ<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Один или несколько атрибутов<o:p></o:p></span></p> </td> </tr> <tr> <td width="213" valign="top"> <p style="text-align: center;"><span>Тип данных<o:p></o:p></span></p> </td> <td width="413" valign="top"> <p style="text-align: center;"><span>Тип значений элементов таблицы<o:p></o:p></span></p> </td> </tr> </table> <p><i><span> </span></i><span><o:p></o:p></span></p> <p><b><i><span>Отношение</span></i></b><i><span> </span></i><span>является важнейшим понятием и представляет собой двумерную таблицу, содержащую некоторые данные.<o:p></o:p></span></p> <p><b><i><span>Сущность </span></i></b><span>есть объект любой природы, данные о котором хранятся в базе <span>данных. Данные о сущности хранятся в отношении.</span><o:p></o:p></span></p> <p><b><i><span>Атрибуты </span></i></b><span>представляют собой свойства, характеризующие сущность. </span><span>В структуре таблицы каждый атрибут именуется и ему соответствует заго­<span>ловок некоторого столбца таблицы.</span><o:p></o:p></span></p> <p><b><i><span>Домен </span></i></b><span>представляет собой множество всех возможных значений опре­деленного атрибута отношения. <o:p></o:p></span></p> <p><b><i><span>Схема отношения (заголовок отношения) </span></i></b><span>представляет собой спи­</span><span>сок имен атрибутов. Множество собственно кортежей отношения часто называют <b><i>содержи­<span>мым </span></i></b><i><span>(телом) <b>отношения.</b></span></i><o:p></o:p></span></p> <p><span> На рис 1 приведен пример представления отношения СОТРУДНИК.</span><span><o:p></o:p></span></p> <p style="text-align: center;"><span><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Рисунок_x0020_8" o:spid="_x0000_i1025" type="#_x0000_t75"
 style='width:397.5pt;height:252pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image001.png"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image002.jpg" v:shapes="Рисунок_x0020_8"></span>
<span><o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 1. Представление отношения СОТРУДНИК<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Отношение СОТРУДНИК включает 4 до<span>мена. <i>Домен 1 </i>содержит фамилии всех сотрудников, <i>домен 2 — </i>номера всех </span><span>отделов фирмы, <i>домен 3 </i>— названия всех должностей, <i>домен 4 — </i>даты рож­</span><span>дения всех сотрудников. Каждый домен образуют значения одного типа дан­</span><span>ных, например, числовые или символьные.</span><o:p></o:p></span></p> <p><span>Отношение СОТРУДНИК содержит 3 кортежа. Кортеж рассматривае­</span><span>мого отношения состоит из 4 элементов, каждый из которых выбирается из соответствующего домена. Каждому кортежу соответствует строка таб­<span>лицы. Д</span>ля приведенного примера схема отно­<span>шения имеет вид<span> </span>СОТРУДНИК (ФИО, Отдел, Должность, Д_рождения). </span><o:p></o:p></span></p> <p><span>Математически отношение можно описать следующим образом. Пусть </span><span>даны </span><span>n</span><span> множеств </span><span>D</span><span>1, </span><span>D</span><span>2, </span><span>D</span><span>3,..., </span><span>Dn</span><span>, тогда отношение </span><span>R</span><span> есть множество упоря­доченных <b><i>кортежей </i></b><</span><span>dl</span><span>, </span><span>d</span><span>2, </span><span>d</span><span>3 ,..., </span><span>dn</span><b><span>>, </span></b><span>где </span><span>dk</span><span> Є </span><span>Dk</span><span>,<b> </b></span><span>dk</span><b><span> </span></b><b><i><span>— значение </span></i></b><span>k</span><span>-го <b><i>атрибута, </i></b></span><span>a</span><span> </span><span>Dk</span><b><span> </span></b><b><i><span>— <span>домен </span></span></i></b><span>k</span><span>-го <b><i>атрибута</i></b></span><span> отношения </span><i><span>R</span></i><i><span>.</span></i><span><o:p></o:p></span></p> <p><span>В общем случае порядок кортежей в отношении, как и в любом множе­</span><span>стве, не определен. Однако в реляционных СУБД для удобства кортежи <span>все же упорядочивают. Чаще всего для этого выбирают некоторый атри­</span><span>бут, по которому система автоматически сортирует кортежи по возраста­</span>нию или убыванию. Если пользователь не назначает атрибута упорядо­<span>чения, система автоматически присваивает номер кортежам в порядке </span><span>их ввода.</span><o:p></o:p></span></p> <p><span>Формально, если переставить атрибуты в отношении, то получается новое отношение. Однако в реляционных БД перестановка атрибутов не при<span>водит к образованию нового отношения.</span><o:p></o:p></span></p> <p><b><i><span>Первичным ключом (ключом отношения, ключевым атрибутом) </span></i></b><span>на<span>зывается атрибут отношения, однозначно идентифицирующий каждый из его кортежей. Например, в отношении из примера (рис.2.1) </span>ключевым является атрибут "ФИО". <i>Ключ </i>может быть <b><i>составным (сложным), </i></b>т. е. состоять из нескольких атрибутов,<o:p></o:p></span></p> <p><span>Каждое отношение обязательно имеет комбинацию атрибутов, которая </span><span>может служить ключом. Ее существование гарантируется тем, что отноше</span><span>ние — это множество, которое не содержит одинаковых элементов — корте</span><span>жей. Т.е. в отношении нет повторяющихся кортежей, а это значит, что по <span>крайней мере вся совокупность атрибутов обладает свойством однозначной идентификации кортежей отношения. Во многих СУБД допускается </span><span>создавать отношения, не определяя ключи.</span><o:p></o:p></span></p> <p><span>Возможны случаи, когда отношение имеет несколько комбинаций атрибутов, каждая из которых однозначно определяет все кортежи от­ношения. Все эти комбинации атрибутов являются <b><i>возможными клю­чами </i></b>отношения. Любой из возможных ключей может быть выбран как <i><span>первичный.</span></i><o:p></o:p></span></p> <p><span>Если выбранный первичный ключ состоит из минимально необходимо­</span><span>го набора атрибутов, говорят, что он является <b><i>не избыточным. </i></b><span>Ключи обычно используют для достижения следующих целей: </span><o:p></o:p></span></p> <p><span>1) исключения дублирования значений в ключевых атрибутах (осталь­</span><span>ные атрибуты в расчет не принимаются);</span><span><o:p></o:p></span></p> <p><span>2) упорядочения кортежей. Возможно упорядочение по возрастанию или <span>убыванию значений всех ключевых атрибутов, а также смешанное упорядочение (по одним — возрастание, а по другим — убывание); </span><o:p></o:p></span></p> <p><span>3) ускорения работы </span><span>c</span><span> кортежами отношения; </span><span><o:p></o:p></span></p> <p><span>4) организации связывания таблиц. </span><span><o:p></o:p></span></p> <p><span>Пусть в отношении </span><span>R</span><span>1 имеется <i>не ключевой </i>атрибут А, значения которо<span>го являются значениями <i>ключевого </i>атрибута В другого отношения </span></span><span>R</span><span>2. Тогда </span><span>говорят, что атрибут А отношения </span><span>R</span><span>1 есть <b><i>внешний ключ.</i></b></span><span><o:p></o:p></span></p> <p><span>С помощью внешних ключей устанавливаются связи между отношения<span>ми. Например, имеются два отношения </span><o:p></o:p></span></p> <p><span>СТУДЕНТ (<u>ФИО</u>, Группа, Специ</span><span>альность) и ПРЕД</span><span>ME</span><span>Т (<u>Назв.Пр</u>, Часы), которые связаны отношением СТУДЕНТ_ПРЕДМЕТ(<u>ФИО, Назв.Пр</u>, Оценка) (рис. 2). В связующем </span><span>отношении атрибуты ФИО и Назв.Пр образуют составной ключ. Эти атри<span>буты представляют собой внешние ключи, являющиеся первичными клю</span><span>чами других отношений.</span><o:p></o:p></span></p> <p style="text-align: center;"><span><!--[if gte vml 1]><v:shape id="Рисунок_x0020_9" o:spid="_x0000_i1026"
 type="#_x0000_t75" style='width:430.5pt;height:159pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image003.jpg"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image004.jpg" v:shapes="Рисунок_x0020_9"></span><span><o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 2. Связь отношений<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Реляционная модель накладывает на внешние ключи ограничение для <span>обеспечения целостности данных, называемое <i>ссылочной целостностью. </i>Это </span>означает, что каждому значению внешнего ключа должны соответствовать строки в связываемых отношениях.<o:p></o:p></span></p> <p><span>Поскольку не всякой таблице можно поставить в соответствие отноше</span><span>ние, приведем условия, выполнение которых позволяет таблицу считать отношением.<o:p></o:p></span></p> <p><span>l</span><span>. </span><span>Bce</span><span> строки<sup>:</sup> таблицы должны быть уникальны, т. е. не может быть строк </span><span>с<i> </i>одинаковыми первичными ключами.<o:p></o:p></span></p> <p><span>2. Имена столбцов таблицы должны быть различны, а значения их просты­</span><span>ми, т. е. недопустима группа значений в одном столбце одной строки.</span><span><o:p></o:p></span></p> <p><span>З. Все строки одной таблицы должны иметь одну структуру, соответству­</span><span>ющую именам и типам столбцов.<o:p></o:p></span></p> <p><span>4. Порядок размещения строк в таблице может быть произвольным.</span><span><o:p></o:p></span></p> <p><span>Наиболее часто таблица с отношением размещается в отдельном файле. В некоторых СУБД одна отдельная таблица (отношение) считается базой </span><span>данных. В других СУБД база данных может содержать несколько таблиц.</span><span><o:p></o:p></span></p> <p><span>В общем случае можно считать, что БД включает одну или несколько </span><span>таблиц, объединенных смысловым содержанием, а также процедурами кон</span><span>троля целостности и обработки информации в интересах решения некото</span><span>рой прикладной задачи. Например, при использовании СУБД </span><span>Microsoft</span><span> </span><span>Access</span><span> в файле БД наряду с таблицами хранятся и другие объекты базы: </span><span>запросы, отчеты, формы, макросы и модули.</span><span><o:p></o:p></span></p> <p><span>Таблица данных обычно хранится на магнитном диске в отдельном файле операционной системы, поэтому по ее именованию могут существовать <span>ограничения. Имена полей хранятся внутри таблиц. Правила их формиро</span><span>вания определяются СУБД, которые, как правило, на длину полей и исполь</span><span>зуемый алфавит серьезных ограничений не накладывают.</span><o:p></o:p></span></p> <p><span>Если задаваемое таблицей отношение имеет ключ, то считается, что таб<span>лица тоже имеет ключ и ее называют <b><i>ключевой </i></b>или <b><i>таблицей с ключевы</i></b></span><b><i><span>ми полями.</span></i></b><o:p></o:p></span></p> <p><span>У большинства СУБД файл таблицы включает управляющую часть (опи­</span><span>сание типов полей, имена полей и другая информация) и область размеще­<span>ния записей.</span><o:p></o:p></span></p> <p><span>К отношениям можно применять систему операций, позволяющую по­</span><span>лучать одни отношения из других. Например, результатом запроса к реля­<span>ционной БД может быть новое отношение, вычисленное на основе имеющихся отношений. Поэтому можно разделить обрабатываемые данные на хранимую и вычисляемую части.</span><o:p></o:p></span></p> <p><span>Основной единицей обработки данных в реляционных БД является от­</span><span>ношение, а не отдельные его кортежи (записи).</span><span><o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <h3 style="text-align: center;"><a><span>12.2 Связывание таблиц</span></a><a></a><span><span><o:p></o:p></span></span></h3>
<h3 style="text-align: center;"><span><span>12.2.1 Назначение и основные виды связывания таблиц</span></span><span><o:p></o:p></span></h3> <p><span><o:p> </o:p></span></p> <p><span>При проектировании реальных БД информацию обычно размещают в </span><span>нескольких таблицах. Таблицы при этом связаны семантикой информации. В реляционных СУБД для указания связей таблиц производят операцию их связывания.<o:p></o:p></span></p> <p><span>Укажем выигрыш, обеспечиваемый в результате связывания таблиц. Многие СУБД при связывании таблиц автоматически выполняют конт</span><span>роль целостности вводимых в базу данных в соответствии с установлен</span><span>ными связями. В конечном итоге это <i>повышает достоверность </i>хранимой </span><span>в БД информации.</span><span><o:p></o:p></span></p> <p><span>Кроме того, установление связи между таблицами <i>облегчает доступ </i>к </span><span>данным. Связывание таблиц при выполнении таких операций, как поиск, </span><span>просмотр, редактирование, выборка и подготовка отчетов, обычно обеспе­чивает возможность обращения к произвольным полям связанных запи<span>сей. Это уменьшает количество явных обращений к таблицам данных и чис</span><span>ло манипуляций в каждой из них.</span><o:p></o:p></span></p> <p><b><span> </span></b><span>Между таблицами могут устанавливаться бинарные (между двумя таб­<span>лицами), тернарные (между тремя таблицами) и, в общем случае, </span></span><span>n</span><span>-арные </span><span>связи. Рассмотрим наиболее часто встречающиеся <i>бинарные </i>связи.<o:p></o:p></span></p> <p><span>При связывании двух таблиц выделяют основную и дополнительную (подчиненную) таблицы. Логическое связывание таблиц производится с <span>помощью <b><i>ключа связи.</i></b></span><o:p></o:p></span></p> <p><span>Ключ связи, по аналогии с обычным ключом таблицы, состоит из одного </span><span>или нескольких полей, которые в данном случае называют <b><i>полями связи </i></b>(ПС).</span><span><o:p></o:p></span></p> <p><span>Суть связывания состоит в установлении соответствия полей связи ос­<span>новной и дополнительной таблиц. Поля связи основной таблицы могут быть </span>обычными и ключевыми. В качестве полей связи подчиненной таблицы чаще всего используют ключевые поля.<o:p></o:p></span></p> <p><span>В зависимости от того, как определены поля связи основной и дополни­</span><span>тельной таблиц (как соотносятся ключевые поля с полями связи), между <span>двумя таблицами в общем случае могут устанавливаться следующие четыре основных вида связи (табл. 2):</span><o:p></o:p></span></p> <p><span>один — один (1:1);</span><span><o:p></o:p></span></p> <p><span>один — много (1 :М);</span><span><o:p></o:p></span></p> <p><span>много — один (М:1);<o:p></o:p></span></p> <p><span>много — много (М:М или </span><span>M</span><span>:</span><span>N</span><span>).<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: right;"><span>Таблица 2<span> </span><o:p></o:p></span></p> <p style="text-align: center;"><span>Характеристика видов связей таблиц</span><span><o:p></o:p></span></p> <table border="1" cellspacing="0" cellpadding="0" width="659" style="margin:0 auto;"> <tr> <td width="168" valign="top"> <p style="text-align: center;"><span>Характеристика полей </span><span>связи по видам</span><span><o:p></o:p></span></p> </td> <td width="113"> <p style="text-align: center;"><span>1</span><span>:1</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>1:М</span><span><o:p></o:p></span></p> </td> <td width="132"> <p style="text-align: center;"><span>М:1</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>М:М</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="168" valign="top"> <p style="text-align: center;"><span>Поля связи основной</span><span> таблицы</span><span><o:p></o:p></span></p> </td> <td width="113"> <p style="text-align: center;"><span>являются ключом</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>являются ключом</span><span><o:p></o:p></span></p> </td> <td width="132"> <p style="text-align: center;"><span>не являются ключом</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>не являются ключом</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="168" valign="top"> <p style="text-align: center;"><span>Поля связи дополнительной </span><span>таблицы</span><span><o:p></o:p></span></p> </td> <td width="113"> <p style="text-align: center;"><span>являются ключом</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>не являются ключом</span><span><o:p></o:p></span></p> </td> <td width="132"> <p style="text-align: center;"><span>являются ключом</span><span><o:p></o:p></span></p> </td> <td width="123"> <p style="text-align: center;"><span>не являются ключом</span><span><o:p></o:p></span></p> </td> </tr> </table> <p><span> </span><span><o:p></o:p></span></p> <p><span>Дадим характеристику названным видам связи между двумя таблицами <span>и приведем примеры их использования.<o:p></o:p></span></span></p> <p><span><o:p> </o:p></span></p> <h4 style="text-align: center;"><a><span>12.2.1.2<span> </span>Межтабличная связь вида 1:1</span></a><span><o:p></o:p></span></h4> <p><span><o:p> </o:p></span></p> <p><span>Связь вида 1:1 образуется в случае, когда все поля связи основной и до­полнительной таблиц являются ключевыми. Поскольку значения в ключе<span>вых полях обеих таблиц не повторяются, обеспечивается взаимно-одно</span><span>значное соответствие записей из этих таблиц. Сами таблицы, по сути, здесь </span><span>становятся равноправными.</span><o:p></o:p></span></p> <p><b><span>Пример 1.</span></b><span> <span>Пусть имеются основная О1 и дополнительная Д1 таблицы. Ключевые </span><span>поля обозначим символом «*», используемые для связи поля обозначим </span><span>символом «+».</span><o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица О1</span><span><o:p></o:p></span></p> <p><span>*<span> </span>+</span><span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="149" valign="top"> <p style="text-align: center;"><span>Поле11<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p style="text-align: center;"><span>Поле12<o:p></o:p></span></p> </td> </tr> <tr> <td width="149" valign="top"> <p style="text-align: center;"><span>а<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p style="text-align: center;"><span>10<o:p></o:p></span></p> </td> </tr> <tr> <td width="149" valign="top"> <p style="text-align: center;"><span>б<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p style="text-align: center;"><span>40<o:p></o:p></span></p> </td> </tr> <tr> <td width="149" valign="top"> <p style="text-align: center;"><span>в<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p style="text-align: center;"><span>3<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> </span><span><o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица Д1</span><span><o:p></o:p></span></p> <p><span>*<span> </span>+</span><span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="149" valign="top"> <p><span>Поле21<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p><span>Поле22<o:p></o:p></span></p> </td> </tr> <tr> <td width="149" valign="top"> <p><span>а<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p><span>стол<o:p></o:p></span></p> </td> </tr> <tr> <td width="149" valign="top"> <p><span>в<o:p></o:p></span></p> </td> <td width="161" valign="top"> <p><span>книга<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p><span>В приведенных таблицах установлена связь между записью (а, 10) таб­<span>лицы О1 и записью (а, стол) таблицы Д1. Основанием этого является совпа­</span>дение значений в полях связи. Аналогичная связь существует и между за­<span>писями (в, 3) и (в, книга) этих же таблиц. В таблицах записи отсортированы </span><span>по значениям в ключевых полях.</span><o:p></o:p></span></p> <p><span>Сопоставление записей двух таблиц по существу означает образование новых «виртуальных записей» (псевдозаписей). Так, первую пару записей </span><span>логически можно считать новой псевдозаписью вида (а, 10, стол), а вторую пару — псевдозаписью вида (в, 3, книга).</span><span><o:p></o:p></span></p> <p><span>На практике связи вида 1:1 используются сравнительно редко, так как </span><span>хранимую в двух таблицах информацию легко объединить в одну таблицу, которая занимает гораздо меньше места в памяти ЭВМ. Возможны случаи, <span>когда удобнее иметь не одну, а две и более таблицы. Причинами этого может </span><span>быть необходимость ускорить обработку, повысить удобство работы не­</span>скольких пользователей с общей информацией, обеспечить более высокую <span>степень защиты информации и т. д. <o:p></o:p></span></span></p> <p><span><o:p> </o:p></span></p> <h4><a><span>12.2.1.3<span> </span>Межтабличные связи вида 1:М и вида М:1</span></a><span><o:p></o:p></span></h4> <p><span> <o:p></o:p></span></p> <p><span>Связь 1:М имеет место в случае, когда одной записи основной таблицы <span>соответствует несколько записей вспомогательной таблицы. <o:p></o:p></span></span></p> <p><b><span>Пример 2.</span></b><span> <span>Пусть имеются две связанные таблицы О2 и Д2. В таблице О2 содержит</span><span>ся информация о видах мультимедиа-устройств ПЭВМ, а в таблице Д2 - сведения о фирмах-производителях этих устройств, а также о наличии на </span>складе хотя бы одного устройства.<o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица О2<o:p></o:p></span></p> <p><span>*<span> </span>+</span><span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="66"> <p style="text-align: center;"><span>Код</span><span><o:p></o:p></span></p> </td> <td width="163"> <p style="text-align: center;"><span>Вид устройства</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="66"> <p style="text-align: center;"><span>а</span><span><o:p></o:p></span></p> </td> <td width="163"> <p style="text-align: center;"><span>CD</span><span>-</span><span>ROM</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="66"> <p style="text-align: center;"><span>б</span><span><o:p></o:p></span></p> </td> <td width="163"> <p style="text-align: center;"><span>CD</span><span>-</span><span>Recorder</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="66"> <p style="text-align: center;"><span>в</span><span><o:p></o:p></span></p> </td> <td width="163"> <p style="text-align: center;"><span>Sound</span><span> </span><span>Blaster</span><span><o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: right;"><span>Таблица Д2<o:p></o:p></span></p> <p><span>*<span> </span>+ <span> </span>*</span><span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="50" valign="top"> <p style="text-align: center;"><span>Код<o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Фирма-производитель</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>Наличие</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>a</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Acer</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>a</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Mitsumi</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>нет<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>a</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>NEC</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>a</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Panasonic</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>a</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Sony</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>6</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Philips</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>нет<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>6</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Sony</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>нет<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>6</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Yamaha</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> <tr> <td width="50"> <p style="text-align: center;"><span>в<o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Creative Labs</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>да<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> </span><span><o:p></o:p></span></p> <p><span>Таблица Д2 имеет два ключевых поля, так как одна и та же фирма может </span><span>производить устройства различных видов. В примере фирма </span><span>Sony</span><span> произ­водит устройства считывания и перезаписи с компакт-дисков.<o:p></o:p></span></p> <p><span>Сопоставление записей обеих таблиц по полю «Код» порождает псевдо­</span><span>записи вида: (</span><span>a</span><span>, </span><span>CD</span><span>-</span><span>ROM</span><span>, </span><span>Acer</span><span>, да), (</span><span>a</span><span>, </span><span>CD</span><span>-</span><span>ROM</span><span>, </span><span>Mitsumi</span><span>, нет), (</span><span>a</span><span>, </span><span>CD</span><span>-</span><span>ROM</span><span>, </span><span>NEC</span><span>, да), (</span><span>a</span><span>, </span><span>CD</span><span>-</span><span>ROM</span><span>, </span><span>Panasonic</span><span>, да), (</span><span>a</span><span>, </span><span>CD</span><span>-</span><span>ROM</span><span>, </span><span>Sony</span><span>, да), (б, </span><span>CD</span><span>-</span><span>Recorder</span><span>, </span><span>Philips</span><span>, нет), (б, </span><span>CD</span><span>-</span><span>Recorder</span><span>, </span><span>Sony</span><span>, нет) и т. д.</span><span><o:p></o:p></span></p> <p><span>Если свести псевдозаписи в новую таблицу, то получим полную ин­</span><span>формацию обо всех видах мультимедиа-устройств ПЭВМ, фирмах, их </span><span>производящих, а также сведения о наличии конкретных видов уст</span><span>ройств на складе.</span><span><o:p></o:p></span></p> <p><span>Связь вида М:1 имеет место в случае, когда одной или нескольким записям основ<span>ной таблицы ставится в соответствие одна запись дополнительной таблицы.</span><o:p></o:p></span></p> <p><b><span>Пример 3.</span></b><span> </span><span>Рассмотрим связь таблиц ОЗ и ДЗ. В основной таблице ОЗ содер</span><span>жится информация о названиях деталей (Поле11), видах материалов, <span>из которого детали можно изготовить (Поле12), и марках материала </span><span>(Поле13). В дополнительной таблице ДЗ содержатся сведения о назва</span><span>ниях деталей (Поле21), планируемых сроках изготовления (Поле22) и </span>стоимости заказов (Поле23).<o:p></o:p></span></p> <p><span>Связывание этих таблиц обеспечивает такое установление соответствия <span>между записями, которое эквивалентно образованию следующих псевдо</span><span>записей: (деталь1, чугун, марка1, 4.04.98, 90), (деталь1, чугун, марка2, 4.04.98, 90),<span> </span>(деталь2, сталь, марка1, 4.01.98, 35),<span> </span>(деталь2, сталь, марка2, 4.01.98, 35),<span> </span></span>(деталь2, сталь, марка3, 4.01.98, 35), (деталь3, алюминий, — , 17.02.98, 90), <span>(деталъ4, чугун, марка2, 6.05.98, 240).</span><o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица О3</span><span><o:p></o:p></span></p> <p><span>+</span><span><o:p></o:p></span></p> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>Поле </span><span>11</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>Поле12</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>Поле </span><span>13</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь1</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>чугун</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>марка </span><span>1</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь1<o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>чугун</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>марка2</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь2</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>сталь</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>марка1</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь2</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>сталь</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>марка2</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь2</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>сталь</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>Марка3</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>Деталь3</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>алюминий</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>-</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="78" valign="top"> <p style="text-align: center;"><span>деталь4</span><span><o:p></o:p></span></p> </td> <td width="104" valign="top"> <p style="text-align: center;"><span>чугун</span><span><o:p></o:p></span></p> </td> <td width="94" valign="top"> <p style="text-align: center;"><span>марка2</span><span><o:p></o:p></span></p> </td> </tr> </table> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: right;"><span>Таблица ДЗ <o:p></o:p></span></p> <p><span>* <span> </span>+</span><span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="85" valign="top"> <p><span>Поле21</span><span> <o:p></o:p></span></p> </td> <td width="85" valign="top"> <p><span>Поле22</span><span> <o:p></o:p></span></p> </td> <td width="76" valign="top"> <p><span>Поле23</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="85" valign="top"> <p><span>деталь 1</span><span> <o:p></o:p></span></p> </td> <td width="85" valign="top"> <p><span>4.04.98</span><span> <o:p></o:p></span></p> </td> <td width="76" valign="top"> <p><span>90</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="85" valign="top"> <p><span>деталь2</span><span> <o:p></o:p></span></p> </td> <td width="85" valign="top"> <p><span>4.01.98</span><span> <o:p></o:p></span></p> </td> <td width="76" valign="top"> <p><span>35</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="85" valign="top"> <p><span>Деталь3</span><span> <o:p></o:p></span></p> </td> <td width="85" valign="top"> <p><span>17.02.98</span><span> <o:p></o:p></span></p> </td> <td width="76" valign="top"> <p><span>90</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="85" valign="top"> <p><span>деталь4</span><span> <o:p></o:p></span></p> </td> <td width="85" valign="top"> <p><span>6.05.98</span><span> <o:p></o:p></span></p> </td> <td width="76" valign="top"> <p><span>240</span><span> <o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <span> </span><o:p></o:p></span></p> <p><span>Полученная псевдотаблица может быть полезна при планировании или </span><span>принятии управленческих решений, когда необходимо иметь все возможные варианты исполнения заказов по каждому изделию. Отметим, что таблица ОЗ не имеет ключей и в ней возможно повторение записей. Если таблицу ДЗ <span>сделать основной, а таблицу ОЗ — дополнительной, получим связь вида 1:М. </span>Поступив аналогично с таблицами О2 и Д2, можно получить связь вида М:1. <span>Отсюда следует, что вид связи (1:М или М:1) зависит от того, какая таблица </span>является главной, а какая дополнительной.<o:p></o:p></span></p> <h4><span><o:p> </o:p></span></h4> <h4 style="text-align: center;"><span>12.2.1.4 Межтабличная связь вида М:М<span><o:p> </o:p></span></h4> <p><span>Самый общий вид связи М:М возникает в случаях, когда нескольким <span>записям основной таблицы соответствует несколько записей дополни</span>тельной таблицы.<o:p></o:p></span></p> <p><b><span>Пример 4.</span></b><span> </span><span>Пусть в основной таблице О4 содержится информация о том, на каких </span><span>станках могут работать рабочие некоторой бригады. Таблица Д4 содержит </span><span>сведения о том, кто из бригады ремонтников какие станки обслуживает.</span><span><o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица О4<o:p></o:p></span></p> <p><span><span> </span><span> </span><span> </span><span>*<span> </span><span> </span>*<span> </span>+</span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="123" valign="top"> <p><span> <span>Работает</span> <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>На станке</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p><span>Иванов А.В.</span><span> <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>станок1</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p><span>Иванов А.В.</span><span> <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>станок2</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p><span>Петров Н.Г <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>станок1</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p><span>Петров Н.Г <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>станокЗ</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p><span>Сидоров В. К.</span><span> <o:p></o:p></span></p> </td> <td width="104" valign="top"> <p><span>станок2</span><span> <o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: right;"><span>Таблица Д4<o:p></o:p></span></p> <p><span>*<span> </span><span> </span><span>*<span> </span>+</span><o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="132" valign="top"> <p><span> <span>Обслуживает</span> <o:p></o:p></span></p> </td> <td width="94" valign="top"> <p><span>Станок <o:p></o:p></span></p> </td> </tr> <tr> <td width="132" valign="top"> <p><span>Голубев Б. С.</span><span> <o:p></o:p></span></p> </td> <td width="94" valign="top"> <p><span>станок 1</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="132" valign="top"> <p><span>Голубев Б. С.</span><span> <o:p></o:p></span></p> </td> <td width="94" valign="top"> <p><span>Станок3</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="132" valign="top"> <p><span>Зыков А.Ф.</span><span> <o:p></o:p></span></p> </td> <td width="94" valign="top"> <p><span>станок2</span><span> <o:p></o:p></span></p> </td> </tr> <tr> <td width="132" valign="top"> <p><span>Зыков А.Ф.</span><span> <o:p></o:p></span></p> </td> <td width="94" valign="top"> <p><span>Станок3</span><span> <o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p><span>Первой и третьей записям таблицы О4 соответствует первая запись таблицы Д4 (у всех этих записей значение второго поля — «станок1»). Четвертой записи таблицы О4 соответствуют вторая и четвертая записи таблицы Д4 (во втором поле этих записей содержится «станок3»).<o:p></o:p></span></p> <p><span>Исходя из определения полей связи этих таблиц можно составить но­вую таблицу с именем «О4+Д4», записями которой будут псевдозаписи. <span>Записям полученной таблицы можно придать смысл возможных смен, </span>составляемых при планировании работы. Для удобства, поля новой таб<span>лицы переименованы (кстати, такую операцию предлагают многие из со</span>временных СУБД).<o:p></o:p></span></p> <p style="text-align: right;"><span> Таблица «О4+Д4»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Работа</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>Станок<o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Обслуживание</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Иванов А.В.</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>станок </span><span>1</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Голубев Б. С.</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Иванов А.В.</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>станок2</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Зыков А.Ф.</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Петров Н.Г.</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>станок1</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Голубев Б. С.</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Петров Н.Г.</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>Станок3</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Голубев Б. С.</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Петров Н.Г<o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>Станок3<o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Зыков А.Ф.</span><span><o:p></o:p></span></p> </td> </tr> <tr> <td width="124" valign="top"> <p style="text-align: center;"><span>Сидоров В. К.</span><span><o:p></o:p></span></p> </td> <td width="85" valign="top"> <p style="text-align: center;"><span>станок2</span><span><o:p></o:p></span></p> </td> <td width="132" valign="top"> <p style="text-align: center;"><span>Зыков А.Ф.</span><span><o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> </span><span><o:p></o:p></span></p> <p><span>Приведенную таблицу можно использовать, например, для получения от­</span><span>вета на вопрос: «Кто обслуживает станки, на которых трудится Петров?».<o:p></o:p></span></p> <p><span>Очевидно, аналогично связи 1:1, связь М:М не устанавливает подчинен<span>ности таблиц. Для проверки этого можно основную и дополнительную таб</span>лицу поменять местами и выполнить объединение информации путем связывания. Результирующие таблицы «О4+Д4» и «Д4+О4» будут отличаться <span>порядком следования первого и третьего полей, а также порядком располо</span><span>жения записей.</span><o:p></o:p></span></p> <p><i><span>Замечание.</span></i><span> <span>На практике в связь обычно вовлекается сразу несколько таблиц. При </span>этом одна из таблиц может иметь различного рода связи с несколькими таб­лицами. В случаях, когда связанные таблицы, в свою очередь, имеют связи с <span>другими таблицами, образуется иерархия или дерево связей.<o:p></o:p></span></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><a><b><span>12.3 Контроль целостности связей</span></b></a><b><span><o:p></o:p></span></b></p> <p><span> Из перечисленных видов связи наиболее широко используется связь вида 1:М. Связь вида 1:1 можно считать частным случаем связи 1:М, когда одной <span>записи главной таблицы соответствует одна запись вспомогательной табли</span>цы. Связь М:1, по сути, является «зеркальным отображением» связи 1:М. Ос<span>тавшийся вид связи М:М характеризуется как слабый вид связи или даже </span><span>как отсутствие связи. Поэтому в дальнейшем рассматривается связь вида 1:М.</span><o:p></o:p></span></p> <p><span>Напомним, что при образовании связи вида 1:М одна запись главной </span><span>таблицы (главная, родительская запись) оказывается связанной с несколь­<span>кими записями дополнительной (дополнительные, подчиненные записи) </span>и имеет место схема, показанная на рис. 3.<o:p></o:p></span></p> <p><span><!--[if gte vml 1]><v:shape id="Рисунок_x0020_10" o:spid="_x0000_i1027"
 type="#_x0000_t75" style='width:396pt;height:155.25pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image005.png"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image006.jpg" v:shapes="Рисунок_x0020_10"></span><span><o:p></o:p></span></p> <p style="text-align: center;"><span>Рис</span><span>.<b> </b>4</span><span>.3. </span><span>Связь</span><span> 1:</span><span>М</span><span> </span><span>записей</span><span> </span><span>двух</span><span> </span><span>таблиц<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Контроль целостности связей обычно означает анализ содержимого двух <span>таблиц на соблюдение следующих правил:</span><o:p></o:p></span></p> <p><span>— </span><span>каждой записи основной таблицы соответствует нуль или более записей дополнительной таблицы;</span><span><o:p></o:p></span></p> <p><span>— </span><span>в дополнительной таблице нет записей, которые не имеют родительских записей в основной таблице;</span><span><o:p></o:p></span></p> <p><span>— </span><span>каждая запись дополнительной таблицы имеет только одну родитель</span><span>скую запись основной таблицы.</span><span><o:p></o:p></span></p> <p><span> Опишем действие контроля целостности при манипулировании данными <span>в таблицах. Рассмотрим три основные операции над данными двух таблиц: </span>ввод новых записей, м<span>одификацию записей, </span><span>удаление записей.</span><o:p></o:p></span></p> <p><span>При <b><i>вводе новых записей </i></b>возникает вопрос определения последователь­</span><span>ности ввода записей в таблицы такой, чтобы не допустить нарушение </span><span>целостности. Исходя из приведенных правил, логичной является схема, при </span><span>которой данные сначала вводятся в основную таблицу, а потом — в допол­</span><span>нительную. Очередность ввода может быть установлена на уровне целых </span><span>таблиц или отдельных записей (случай одновременного ввода в несколько <span>открытых таблиц).</span><o:p></o:p></span></p> <p><span>В процессе заполнения <i>основной </i>таблицы контроль значений полей связи </span><span>ведется как контроль обычного ключа (на совпадение со значениями тех же <span>полей других записей). Заполнение полей связи <i>дополнительной </i>таблицы </span>контролируется на предмет совпадения со значениями полей связи основ­ной таблицы. Если вновь вводимое значение в поле связи дополнительной <span>таблицы не совпадет ни с одним соответствующим значением в записях основной таблицы, то ввод такого значения должен блокироваться.</span><o:p></o:p></span></p> <p><b><i><span>Модификация записей. </span></i></b><span>Изменение содержимого полей связанных записей, не относящихся к полям связи, очевидно, должно происходить обыч<span>ным образом. Нас будет интересовать механизм изменения полей связи.</span><o:p></o:p></span></p> <p><span>При редактировании полей связи дополнительной таблицы очевидным </span><span>требованием является то, чтобы новое значение поля связи <i>совпадало с </i>со­<span>ответствующим значением какой-либо записи основной таблицы. </span><span>Т. е. дополнительная запись может сменить <i>родителя, </i>но остаться без </span><span>него не должна.</span><o:p></o:p></span></p> <p><span>Редактирование поля связи основной таблицы разумно подчинить од­<span>ному из следующих правил:</span><o:p></o:p></span></p> <p><span>— </span><span>редактировать записи, у которых нет подчиненных записей. Если есть </span><span>подчиненные записи, то блокировать модификацию полей связи;</span><span><o:p></o:p></span></p> <p><span>— </span><span>изменения в полях связи основной записи мгновенно передавать во </span><span>все поля связи всех записей дополнительной таблицы (каскадное </span><span>обновление).</span><span><o:p></o:p></span></p> <p><span>В операциях <b><i>удаления записей </i></b>связанных таблиц большую свободу, оче­</span><span>видно, имеют записи дополнительной таблицы. Удаление их должно про­<span>исходить практически бесконтрольно. </span>Удаление записей основной таблицы логично подчинить одному из следующих правил:<o:p></o:p></span></p> <p><span>— </span><span>удалять можно запись, которая не имеет подчиненных записей;</span><span><o:p></o:p></span></p> <p><span>— </span><span>запретить (блокировать) удаление записи при наличии подчиненных </span><span>записей, либо удалять ее вместе со всеми подчиненными записями (кас</span><span>кадное удаление).</span><span><o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <h3><a><span>12.4 Основные цели и этапы проектирования баз данных</span></a><span><o:p></o:p></span></h3> <p><span> <o:p></o:p></span></p> <p><span>Основные цели проектирования баз данных (ПБД) следующие:<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>обеспечение хранения в БД всех необходимых данных;<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>обеспечение получения данных по всем необходимым запросам;<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>сокращение избыточности и дублирования данных;<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>обеспечение целостности данных: исключение потери данных, противоречий в содержании БД, нарушений смысла данных;<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>сокращение времени доступа к данным и получения данных по запросам.<o:p></o:p></span></p> <p><span>При проектировании баз данных проектировщик оперирует с описаниями данных и отношений между ними. Описания бывают двух типов: логические и физические. <b>Физическое описание данных</b> определяет способы физической записи данных во внешней памяти. <b>Логическое описание данных</b> указывает на то, в каком виде данные представляются прикладному программисту или пользователю данных.<o:p></o:p></span></p> <p><span>Чтобы уменьшить объем занимаемой памяти или время доступа, физическая запись может содержать несколько логических записей. Структура данных и их взаимосвязь в физической и логической организациях данных могут не совпадать. Преобразование логических предложений и описаний программиста в физическую действительность является задачей программного обеспечения (СУБД).<o:p></o:p></span></p> <p><span>Следует также выделить <b>концептуальный уровень описания данных</b>, реализующий самый высокий уровень абстракции логического описания предметной области и связанных с нею данных. В результате формируется наиболее обобщенное представление данных, не зависящее от СУБД. <o:p></o:p></span></p> <p><span>Таким образом, при проектировании БД выделяют ее концептуальную, логическую и физическую модели и соответствующие им три основных этапа проектирования.<o:p></o:p></span></p> <p><b><i><span>Инфологическое (концептуальное) проектирование</span></i></b><span> – анализ предметной области и ее описание. Этот этап осуществляется без ориентации на какие-либо конкретные программные или технические средства. Результатом данного этапа является формализованная модель предметной области, построенная с использованием специальных языковых средств (обычно – графических). Инфологическая модель, как правило, включает следующие основные элементы:<o:p></o:p></span></p> <p><span>– описание объектов предметной области;<o:p></o:p></span></p> <p><span>– описание атрибутов (свойств) объектов;<o:p></o:p></span></p> <p><span>– описание связей между объектами.<o:p></o:p></span></p> <p><span>Пусть, например, проектируется база данных о промышленном предприятии. Объектами предметной области в данном случае могут являться работники предприятия, его подразделения, другие предприятия – поставщики сырья или потребители продукции, заключенные договоры, виды выпускаемой продукции, конкретные выпущенные изделия и т.д. Эти объекты имеют свойства (атрибуты) – фамилия, адрес и профессия работника, стоимость изделия, объем поставок по договору и т.д. Наконец, объекты находятся в различных связях друг с другом: работник работает в некотором подразделении, подразделения выпускают продукцию, продукция поставляется по договорам другим предприятиям и т.д.<o:p></o:p></span></p> <p><span>Для описания объектов предметной области, их атрибутов и связей между ними обычно применяются стандартизированные системы графических обозначений. Чаще всего применяются </span><span>ER</span><span>-модели (</span><span>ER</span><span>-диаграммы) и семантические объектные модели (</span><span>COM</span><span>-модели).<o:p></o:p></span></p> <p><span>Кроме того, инфологическая модель может включать:<o:p></o:p></span></p> <p><span>– описание основных запросов к проектируемой БД;<o:p></o:p></span></p> <p><span>– описание документооборота, т.е. документов, используемых в качестве источников данных для БД или составляемых на основе БД;<o:p></o:p></span></p> <p><span>– описание алгоритмических связей между данными (например, алгоритмы и формулы для вычисления каких-либо величин, хранящихся в БД или определяемых на основе БД);<o:p></o:p></span></p> <p><span>– описание ограничений целостности, т.е. правил, обеспечивающих актуальность и непротиворечивость данных. Ограничения целостности представляют собой требования к допустимым значениям данных и связям между ними.<o:p></o:p></span></p> <p><b><i><span>Даталогическое проектирование</span></i></b><span> – описание логической структуры данных средствами системы управления базами данных (СУБД), для которой проектируется БД. Такое описание (даталогическая модель) строится на основе инфологической модели по определенным правилам. Для реляционных БД<span> </span>даталогическая модель включает:<o:p></o:p></span></p> <p><span>– описание таблиц;<o:p></o:p></span></p> <p><span>– описание связей между таблицами;<o:p></o:p></span></p> <p><span>– описание атрибутов.<o:p></o:p></span></p> <p><b><i><span>Физическое проектирование</span></i></b><span> – описание физической структуры БД, т.е. ее размещения на запоминающем устройстве. Такое описание называется физической моделью. Физическая модель включает:<o:p></o:p></span></p> <p><span>– тип носителя;<o:p></o:p></span></p> <p><span>– способы организации данных;<o:p></o:p></span></p> <p><span>– способы управления свободной памятью;<o:p></o:p></span></p> <p><span><span> </span></span><span>– способы сжатия данных и т.д.<o:p></o:p></span></p> <p><span>Этот этап, как правило, в основным скрыт от проектировщика БД, так как реализуется средствами СУБД. <o:p></o:p></span></p> <p><i><span>Примечание.</span></i><span> При использовании систем автоматизированного проектирования БД этап инфологического проектирования обычно называют логическим проектированием, а этапы даталогического и физического проектирования – физическим проектированием. <o:p></o:p></span></p> <h3 style="text-align: center;"><a><span>12.5 Цели и порядок проведения нормализации отношений</span></a><span><o:p></o:p></span></h3> <p><span> БД, разработанная по правилам проектирования, должна быть нормализованной, т.е. удовлетворять определенным требованиям, обеспечивающим удобство ее хранения и обновления. Нормализация обеспечивает:<o:p></o:p></span></p> <p><span>минимальную избыточность данных (все данные хранятся один раз);<o:p></o:p></span></p> <p><span>— </span><span>минимальный физический объем данных;<o:p></o:p></span></p> <p><span>— </span><span>ускорение доступа к данным;<o:p></o:p></span></p> <p><span>— </span><span>сокращение риска потери данных или их искажения при внесении изменений в БД.<o:p></o:p></span></p> <p><span>Процесс проектирования БД с использованием метода нормальных форм </span><span>является итерационным и заключается в последовательном переводе отношений из первой нормальной формы в нормальные формы более высокого <span>порядка по определенным правилам. Каждая следующая нормальная форма ограничивает определенный тип функциональных зависимостей, устраняет </span><span>соответствующие аномалии при выполнении операций над отношениями БД </span><span>и сохраняет свойства предшествующих нормальных форм.</span><o:p></o:p></span></p> <p><span>Выделяют следующую последовательность нормальных форм: <span>первая нормальная форма (1НФ); </span>вторая нормальная форма (2НФ); <span>третья нормальная форма (3НФ); </span>усиленная третья нормальная форма или нормальная форма Бойса-<span>Кодда (БКНФ); </span><span>четвертая нормальная форма (4НФ) </span><span>и т.д. (5НФ, 6НФ, 7НФ и выше).</span><o:p></o:p></span></p> <p><i><span>Примечание.</span></i><span> Наряду с точным термином “нормализация отношений”, используются термины “нормализация баз данных”, “нормализация таблиц” или просто “нормализация”. <o:p></o:p></span></p> <p><span>Итак, нормализация выполняется для каждой таблицы, входящей в БД. Выделяется несколько уровней нормализации, соответствующих указанным нормальным формам. Нормализация каждой таблицы выполняется поэтапно: сначала таблица приводится к первой нормальной форме, затем – ко второй, и т.д. На практике в большинстве случаев достаточным оказывается приведение к третьей нормальной форме. Иногда требуется приведение к нормальной форме Бойса-Кодда. Приведение к нормальным формам более высоких порядков (четвертая, пятая, шестая и т.д.) требуется редко.<o:p></o:p></span></p> <p><span>Для выполнения проектирования БД методом нормальных форм необходимо выявление зависимостей между атрибутами. <span>Как уже отмечалось, основной способ определения наличия функциональных зависимостей — </span><span>внимательный анализ семантики атрибутов. </span><o:p></o:p></span></p> <p><span>Выявим зависимости между атрибутами отношения ПРЕПОДАВАТЕЛЬ, приведенного на <span>рис. 4.</span> <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>При этом учтем следующее условие, которое выполняется в данном отношении: один преподаватель в одной группе может проводить один вид занятий (лекции или практические занятия).<o:p></o:p></span></p> <p><span>В результате анализа отношения получаем зависимости между атрибута<span>ми, показанные на рис. 5.<o:p></o:p></span></span></p> <p style="text-align: center;"><span><!--[if gte vml 1]><v:shape id="Рисунок_x0020_11" o:spid="_x0000_i1028"
 type="#_x0000_t75" style='width:407.25pt;height:158.25pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image007.png"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image008.jpg" v:shapes="Рисунок_x0020_11"></span><span><o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 5.<b> </b></span><span>Зависимости между атрибутами</span><span><o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>К выделению этих </span><span>функциональных зависимостей </span><span>(ФЗ) для рассматриваемого примера приводят следую­</span><span>щие соображения.</span><span> </span><span><o:p></o:p></span></p> <p><span>Фамилия, имя и отчество у преподавателей факультета уникальны. Каж­</span><span>дому преподавателю однозначно соответствует его стаж, т. е. имеет место функ­</span><span>циональная зависимость ФИО</span><span>→</span><span>Стаж. Обратное утверждение неверно, так </span><span>как одинаковый стаж может быть у разных преподавателей.<o:p></o:p></span></p> <p><span>Каждый преподаватель имеет определенную добавку за стаж, т. е. имеет <span>место функциональная зависимость ФИО</span></span><span>→</span><span>Д_Стаж, но обратная функцио</span><span>нальная зависимость отсутствует, так как одну и ту же надбавку могут иметь </span><span>несколько преподавателей.</span><span><o:p></o:p></span></p> <p><span> <span>Каждый преподаватель имеет определенную должность (преп., ст.преп. </span>и т.д.), но одну и ту же должность могут иметь несколько препо<span>давателей, т.е. имеет место функциональная зависимость ФИО</span>→<span>Должн, а </span><span>обратная функциональная зависимость отсутствует.</span><o:p></o:p></span></p> <p><span>Каждый преподаватель является сотрудником одной и только одной ка­</span><span>федры. Поэтому функциональная зависимость ФИО</span><span>→<span>Каф имеет место. </span><span>С другой стороны, на каждой кафедре много преподавателей, поэтому обрат</span><span>ной функциональной зависимости нет.</span><o:p></o:p></span></p> <p><span>Каждому преподавателю соответствует конкретный оклад, одина</span><span>ковый для всех педагогов с одинаковыми должностями, что учитывается зависимостями ФИО</span><span>→<span>Оклад и Должн</span>→<span>Оклад. В то же время </span><span>имеет место функциональная зависимость Оклад</span>→<span>Должн, т.к.</span><span> нет одинаковых окладов для разных дол</span><span>жностей.</span><o:p></o:p></span></p> <p><span>Один и тот же преподаватель в одной группе по разным предметам мо­</span><span>жет проводить разные виды занятий. Определение вида занятий, которые </span><span>проводит преподаватель, невозможно без указания предмета и группы, по­</span><span>этому имеет место зависимость ФИО,Предм,Группа</span><span>→<span>ВидЗан. </span><o:p></o:p></span></p> <p><span>Нами не были выделены зависимости между атрибутами ФИО, Предм и </span><span>Группа, поскольку они образуют составной ключ и не учитываются в процессе нормализации исходного отношения.<o:p></o:p></span></p> <p><span>После того, как выделены все функциональные зависимости, следует про</span><span>верить их согласованность с данными исходного отношения ПРЕПОДАВА<span>ТЕЛЬ.</span><o:p></o:p></span></p> <p><span>Например, Должн = 'преп' и Оклад=500 всегда соответствуют друг другу </span><span>во всех кортежах, т. е. подтверждается функциональная зависимость Долж<span>н<—>Оклад. Так же следует верифицировать и остальные функциональные зависимости, не забывая об ограниченности имеющихся в отношении данных.<o:p></o:p></span></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><a><b><span>12.5.1<span> </span>Первая нормальная форма и основная операция нормализации</span></b></a><b><span><o:p></o:p></span></b></p> <p><span> <o:p></o:p></span></p> <p><span>Отношение находится в 1НФ, если все его </span><span>атрибуты являются простыми (имеют атомарные или одиночные значения). <o:p></o:p></span></p> <p><span>Исходное от<span>ношение строится таким образом, чтобы оно было в 1НФ.</span><o:p></o:p></span></p> <p><span>Перевод отношения в следующую нормальную форму осуществляется </span><span>методом «декомпозиции без потерь». Такая декомпозиция должна обеспечить то, что запросы (выборка данных по условию) к исходному отноше</span><span>нию и к отношениям, получаемым в результате декомпозиции, дадут одина<span>ковый результат.</span><o:p></o:p></span></p> <p><span>Основной операцией метода является операция проекции. Поясним ее на примере. Предположим, что в отношении </span><span>R</span><span>(</span><span>A</span><span>,</span><span>B</span><span>,</span><span>C</span><span>,</span><span>D</span><span>,</span><span>E</span><span>,...) устранение функ­</span><span>циональной зависимости С</span><span>→</span><span>D</span><span> позволит перевести его в следующую нормаль­</span><span>ную форму. Для решения этой задачи выполним декомпозицию отношения </span><span>R</span><span> на два новых отношения </span><span>R</span><span>1(</span><span>A</span><span>,</span><span>B</span><span>,</span><span>C</span><span>,</span><span>E</span><span>,...) и </span><span>R</span><span>2(</span><span>C</span><span>,</span><span>D</span><span>). Отношение </span><span>R</span><span>2 являет<span>ся проекцией отношения </span></span><span>R</span><span> на атрибуты С и </span><span>D</span><span>.</span><span><o:p></o:p></span></p> <p><span>Исходное отношение ПРЕПОДАВАТЕЛЬ, используемое для иллюстра­</span><span>ции метода, имеет составной ключ ФИО, Предм, Группа и находится в <span>1НФ,</span> поскольку все его атрибуты простые.<o:p></o:p></span></p> <p><span>В этом отношении в соответствии с рис. 5б можно выделить частичную <span>зависимость атрибутов Стаж, Д_Стаж, Каф, Должн, Оклад от ключа <i>- </i>ука</span>занные атрибуты находятся в функциональной зависимости от атрибута <span>ФИО, являющегося частью составного ключа</span><o:p></o:p></span></p> <p><span>Эта частичная зависимость от ключа приводит к следующему:<o:p></o:p></span></p> <p><span>1.<span> </span><span>В отношении присутствует явное и неявное избыточное дублирование </span><span>данных, например:</span><o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>повторение сведений о стаже, должности и окладе преподавателей, проводящих занятия в нескольких группах и/или по разным предметам;<o:p></o:p></span></p> <p><![if !supportLists]><span><span>·<span> </span></span></span><![endif]><span>повторение сведений об окладах для одной и той же должности или о </span><span>надбавках за одинаковый стаж.</span><span><o:p></o:p></span></p> <p><span>2.</span><span><span> </span>Следствием избыточного дублирования данных является проблема их <span>редактирования</span><i> (аномалия обновления)</i><span>. Например, изменение должности у преподавателя Иванова И.М. потребует просмотра всех кортежей отношения и внесения изменений в те из них, которые содержат сведения о данном преподавателе.</span><o:p></o:p></span></p> <p><span>3.<span> </span></span><i><span>Аномалия добавления (ввода)</span></i><span>: невозможность ввода данных о преподавателе, не назначенном ни на одну группу (так как при этом одно из полей, составляющих ключ БД – номер группы – оказывается пустым). Аналогичным образом невозможным оказывается ввод данных о предмете, пока на него не назначен ни один преподаватель.<o:p></o:p></span></p> <p><span>4.<span> </span><i>Аномалия удаления</i>: при удалении данных о предмете могут быть потеряны данные о преподавателях, ведущих данный предмет, если они не заняты на других предметах. Аналогично, при удалении данных о преподавателе можно потерять данные о предмете, если этот преподаватель был единственным, проводившим занятия по данному предмету.<o:p></o:p></span></p> <p><span>Эти недостатки должны постепенно устраняться по мере приведения БД к последующим нормальным формам.<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><a><b><span>12.5.2 Вторая нормальная форма</span></b></a><b><span><o:p></o:p></span></b></p> <p><span> </span><span><o:p></o:p></span></p> <p><span>Наличие неполных функциональных зависимостей – основная причина недостатков 1НФ. Для их устранения отношения приводятся ко второй нормальной форме (2НФ).<o:p></o:p></span></p> <p><span>Отношение находится в 2НФ, если оно находится в 1НФ и каждый неключевой атрибут функционально полно зави<span>сит от первичного ключа (составного).</span><o:p></o:p></span></p> <p><i><span>Примечани</span></i><span>е. Если таблица имеет простой (т.е. состоящий из одного атрибута) ключ, то она всегда находится в 2НФ (по определению 2НФ).<o:p></o:p></span></p> <p><span>Таблица приводится к 2НФ в следующем порядке:<o:p></o:p></span></p> <p><span>— </span><span>выделяются все атрибуты, <i>находящиеся в полной функциональной зависимости</i> <i>от ключа</i>. Эти атрибуты, вместе с ключом, выделяются в отдельную таблицу;<o:p></o:p></span></p> <p><span>— </span><span>выделяются атрибуты, <i>находящиеся в функциональной зависимости от какой-либо из частей ключа</i>. Эти атрибуты вместе с той частью ключа, от которой они зависят, выделяются в отдельную таблицу. Такое действие выполняется для всех неполных функциональных зависимостей, имеющихся в таблице.<o:p></o:p></span></p> <p><span>То же в терминах реляционной алгебры звучит так: д<span>ля устранения частичной зависимости и перевода отношения в 2НФ не­</span><span>обходимо, используя операцию проекции, разложить его на несколько отно</span><span>шений следующим образом:</span><o:p></o:p></span></p> <p><span>— </span><span>построить проекцию без атрибутов, находящихся в частичной функцио<span>нальной зависимости от первичного ключа;</span><o:p></o:p></span></p> <p><span>— </span><span>построить проекции на части составного первичного ключа и атрибуты, </span><span>зависящие от этих частей.</span><span><o:p></o:p></span></p> <p><span>В результате шага нормализации для примера на рис. 4 получим два отношения </span><span>R</span><span>1 и </span><span>R</span><span>2 в 2НФ (рис. 6).<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><span><!--[if gte vml 1]><v:shape id="Рисунок_x0020_12" o:spid="_x0000_i1029"
 type="#_x0000_t75" style='width:370.5pt;height:294pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image009.png"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image010.jpg" v:shapes="Рисунок_x0020_12"></span><span><o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 6.<b> </b></span><span>Отношения БД в 2НФ<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>В отношении </span><span>R</span><span>1 первичный ключ является составным и состоит из атри­бутов ФИО, Предм, Группа. Напомним, что данный ключ в отношении </span><span>R</span><span>1 </span><span>получен в предположении, что каждый преподаватель в одной группе по одному предмету может либо читать лекции, либо проводить практические за</span><span>нятия. В отношении </span><span>R</span><span>2 ключ ФИО. <o:p></o:p></span></p> <p><span>БД, приведенные к 2НФ, также могут иметь существенные недостатки, как избыточность данных, так и типовые аномалии: добавления (ввода), удаления и обновления. Так, в рассматриваемом примере<span> исследование отношений </span></span><span>R</span><span>1 и </span><span>R</span><span>2 показывает, что переход к 2НФ позво</span><span>лил исключить явную избыточность данных в таблице </span><span>R</span><span>2 - повторение строк </span><span>со сведениями о преподавателях. Однако, в </span><span>R</span><span>2 по-прежнему имеет место неявное дуб</span><span>лирование данных.</span><span><o:p></o:p></span></p> <p><span>Для дальнейшего совершенствования отношения необходимо преобразо</span><span>вать его в 3НФ.</span><span><o:p></o:p></span></p> <p><span> </span><span><o:p></o:p></span></p> <p style="text-align: center;"><a></a><a><span><b><span>12.5.3 Третья нормальная форма</span></b></span></a><b><span><o:p></o:p></span></b></p> <p><span> <o:p></o:p></span></p> <p><span>Основная причина недостатков БД во второй нормальной форме – наличие <i>транзитивных зависимостей, </i>которые порождают избыточное дублирование <span>информации в отношении</span>.<o:p></o:p></span></p> <p><span>Таблица находится <b>в третьей нормальной форме</b> (3НФ), если она находится в 2НФ (а значит, и в 1НФ) и не содержит транзитивных зависимостей.<o:p></o:p></span></p> <p><i><span>Примечание.</span></i><span> Если таблица содержит только один не ключевой атрибут или вообще не содержит не ключевых атрибутов, то она всегда находится в 3НФ, так как в ней не может быть транзитивных зависимостей.<o:p></o:p></span></p> <p><span>Чтобы привести к 3НФ таблицу, содержащую транзитивную зависимость </span><span>A</span><span> </span><span>→ </span><span>B</span><span> </span><span>→ </span><span>C</span><span>, требуется выделить атрибуты </span><span>B</span><span> и </span><span>C</span><span> в отдельную таблицу, где </span><span>B</span><span> становится ключевым атрибутом. Другими словами, для приведения к 3НФ таблица разбивается на две: в одну из них помещаются <i>все</i> атрибуты, <i>кроме</i> атрибута </span><span>C</span><span>, в другую - атрибуты </span><span>B</span><span> и </span><span>C</span><span>.<o:p></o:p></span></p> <p><i><span>Примечание.</span></i><span> <span> </span>Если таблица содержит “длинную” транзитивную зависимость, например, </span><span>A</span><span> </span><span>→ </span><span>B</span><span> </span><span>→ </span><span>C</span><span> </span><span>→ </span><span>D</span><span> </span><span>→ </span><span>E</span><span> (где </span><span>A</span><span> – ключ, </span><span>B</span><span>, </span><span>C</span><span>, </span><span>D</span><span>, </span><span>E</span><span> – не ключевые атрибуты), то сначала в отдельную таблицу выделяются атрибуты </span><span>D</span><span> и </span><span>E</span><span>, затем в другую отдельную таблицу – атрибуты </span><span>C</span><span> и </span><span>D</span><span>, затем – </span><span>B</span><span> и </span><span>C</span><span>.<o:p></o:p></span></p> <p><span>Альтернативные определения 3<span>НФ отношений.</span><o:p></o:p></span></p> <p><span>Определение 1. Отношение находится в ЗНФ, если оно находится в 2НФ </span><span>и каждый неключевой атрибут нетранзитивно зависит от первичного ключа.<o:p></o:p></span></p> <p><span>Определение 2. Отношение находится в ЗНФ в том и только в том случае, <span>если все неключевые атрибуты отношения взаимно независимы и полностью </span><span>зависят от первичного ключа.</span><o:p></o:p></span></p> <p><span>Доказать справедливость этого утверждения несложно. Действительно, то, что неключевые атрибуты полностью зависят от первичного ключа, означает, <span>что данное отношение находится в форме 2НФ. Взаимная независимость ат</span><span>рибутов (определение приведено выше в п. 3.1.2) означает отсутствие всякой зависи</span><span>мости между атрибутами отношения, в том числе и транзитивной зависимос</span>ти между ними. Таким образом, второе определение 3НФ сводится к первому <span>определению.</span><o:p></o:p></span></p> <p><span>Рассмотрим наш пример. Если в отношении </span><span>R</span><span>1 транзитивные зависимости отсутствуют, то в отно</span><span>шении </span><span>R</span><span>2 они есть:</span><span><o:p></o:p></span></p> <p><span>ФИО</span><span>→<span>Должн</span>→<span>Оклад, </span><o:p></o:p></span></p> <p><span>ФИО→Оклад→Должн, <o:p></o:p></span></p> <p><span>ФИО</span><span>→<span>Стаж</span>→<span>Д_Стаж</span><o:p></o:p></span></p> <p><span>Устраним их. Для этого используя операцию </span><span>проекции на атрибуты, являющиеся причиной транзитивных зависимостей, <span>преобразуем отношение </span></span><span>R</span><span>2, получив при этом отношения </span><span>R</span><span>3, </span><span>R</span><span>4 и </span><span>R</span><span>5, каж</span><span>дое из которых находится в 3НФ (рис. 7а). Графически эти отношения </span><span>представлены на рис. 7б. <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><span><!--[if gte vml 1]><v:shape id="Рисунок_x0020_13" o:spid="_x0000_i1030"
 type="#_x0000_t75" style='width:421.5pt;height:275.25pt;visibility:visible'>
 <v:imagedata src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image011.png"
  o:title=""/>
</v:shape><![endif]--> <img src="Тема%20№12.%20Проектирование%20реляционной%20базы%20данных.files/image012.jpg" v:shapes="Рисунок_x0020_13"></span><span><o:p></o:p></span></p> <p><span><span> </span>а)<span> </span>б)<o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 7. Отношения БД в ЗНФ<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Заметим, что отношение </span><span>R</span><span>2 можно преобразо</span><span>вать по-другому, а именно: в отношении </span><span>R</span><span>3 вместо атрибута Должн взять </span><span>атрибут Оклад.</span><span><o:p></o:p></span></p> <p><span>На практике построение 3НФ схем отношений в большинстве случаев яв­</span><span>ляется достаточным и приведением к ним процесс проектирования реляци­<span>онной БД заканчивается. </span><o:p></o:p></span></p> <p><span>В </span><span>нашем примере вся БД деканата приведена к 3НФ. Эта БД состоит из четырех таблиц: </span><span>R</span><span>1, </span><span>R</span><span>3, </span><span>R</span><span>4 и </span><span>R</span><span>5. Сопоставив эти таблицы с исходными данными, приведенными на рис. 4, легко убедиться, что в процессе нормализации никакие данные не потеряны. <span>Постро</span>енные таблицы не имеют недостатков. <span>В полученной БД имеет место необходимое </span>дублирование данных, но отсутствует избыточное. Построенные таблицы также не имеют недостатков, требующих приведения к нормальным формам более высоких порядков <o:p></o:p></span></p> <p><span>Таким образом, проектирование БД деканата завершено.<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p>
 <p style="text-align: center;"><a></a><a><span><b><span>12.5.4 Нормальная форма Бойса-Кодда</span></b></span></a><b><span><o:p></o:p></span></b></p> <p><span> <o:p></o:p></span></p> <p><span>В некоторых редких случаях таблицы, приведенные к 3НФ, тем не менее, обладают недостатками, аналогичными рассмотренным выше. В этом случае требуется приведение таблиц к нормальным формам более высоких порядков.<o:p></o:p></span></p> <p><span>Если в отношении имеется зависимость атрибутов составного ключа от неключевых атрибутов, то необходимо перейти к усиленной НФ, т.е к <span>нормальной форме Бойса - Кодда (БКНФ).</span><o:p></o:p></span></p> <p><span>Отношение находится в БКНФ, если оно находится в 3НФ и в нем отсут­</span><span>ствуют зависимости ключей (атрибутов составного ключа) от не ключевых <span>атрибутов.</span><o:p></o:p></span></p> <p><span>Для более глубокого рассмотрения БКНФ необходимо знать термины <b>детерминант</b> и <b>возможный ключ</b>.<o:p></o:p></span></p> <p><span>Атрибут (или группа атрибутов) называется <b>детерминантом</b>, если от него функционально зависит какой-либо другой атрибут. Другими словами, если имеется функциональная зависимость </span><span>A</span><span> </span><span>→ </span><span>B</span><span>, то </span><span>A</span><span> – детерминант.<o:p></o:p></span></p> <p><span>Атрибут (или группа атрибутов) называется <b>возможным ключом</b>, если он может использоваться в качестве ключа. <o:p></o:p></span></p> <p><span>С учетом этих определений, таблица находится БКНФ, если она находится в 3НФ, и при этом каждый детерминант в таблице является возможным ключом. Таблица, не находящаяся в БКНФ, может иметь ряд аномалий.<o:p></o:p></span></p> <p><span>Пример . Разрабатывается БД о поставках деталей внутри предприятия. На предприятии имеются цехи-поставщики (выпускающие детали, используемые другими цехами) и цехи-заказчики или потребители (использующие детали, выпущенные цехами-поставщиками, и выпускающие готовую продукцию). Известно следующее:<o:p></o:p></span></p> <p><span>— </span><span>каждый цех-поставщик (Цп) выпускает (и поставляет цехам-заказчикам) детали только одного вида;<o:p></o:p></span></p> <p><span>— </span><span>каждый цех-заказчик (Цз) получает детали каждого вида только от одного цеха-поставщика (например, если Цз Ц22 получает гайки от Цп Ц17, то он не получает гайки от каких-либо других цехов);<o:p></o:p></span></p> <p><span>— </span><span>Цп может поставлять детали (одного вида) нескольким Цз;<o:p></o:p></span></p> <p><span>— </span><span>один вид деталей может выпускаться несколькими Цп.<o:p></o:p></span></p> <p><span>Фрагмент БД приведен на рис. 8.<o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Цех-заказчик (Цз)<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>Деталь<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Цех-поставщик (Цп)<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>планка<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц10<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>гайка<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц12<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>этикетка<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц15<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц22<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>гайка<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц17<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц22<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>штепсель<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц11<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц23<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>планка<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц10<o:p></o:p></span></p> </td> </tr> <tr> <td width="178" valign="top"> <p style="text-align: center;"><span>Ц23<o:p></o:p></span></p> </td> <td width="103" valign="top"> <p style="text-align: center;"><span>штепсель<o:p></o:p></span></p> </td> <td width="189" valign="top"> <p style="text-align: center;"><span>Ц11<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p style="text-align: center;"><span>Рис. 8.<span> </span>БД о поставках деталей внутри предприятия<o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span>Здесь ни один из атрибутов в отдельности не является ключом, так как значение любого атрибута в БД может встречаться несколько раз. В качестве ключей могут использоваться комбинации атрибутов (<span>Цз, Деталь</span>) или (<span>Цз, Цп</span>), так как, согласно постановке задачи, любая комбинация значений этих атрибутов может встречаться в БД (структура которой показана на рис. 8) только один раз. Например, любая комбинация значений (<span>Цз, Деталь</span>) встречается в БД только один раз, так как Цз получает детали любого определенного вида только от одного Цп. Комбинация значений (<span>Цз, Цп</span>) встречается в БД только один раз, так как Цз и Цп могут быть связаны поставками только одной детали. Таким образом, комбинации атрибутов (<span>Цз, Деталь</span>) и (<span>Цз, Цп</span>) – возможные ключи. <o:p></o:p></span></p> <p><span>В данном примере имеются следующие функциональные зависимости: (<span>Цз, Деталь</span>) → <span>Цп</span>, (<span>Цз, Цп</span>) → <span>Деталь</span>, <span>Цп </span>→ <span>Деталь</span>. Таким образом, атрибут <i>Цп</i> является детерминантом, но не является возможным ключом. <o:p></o:p></span></p> <p><span>Будем использовать в качестве ключа комбинацию атрибутов (<span>Цз, Деталь</span>). Тогда таблица на рис. 8 находится в 2НФ (так как нет функциональных зависимостей от частей ключа) и в 3НФ (так как отсутствуют транзитивные зависимости вида </span><span>A</span><span> </span><span>→ </span><span>B</span><span> </span><span>→ </span><span>C</span><span>). Однако таблица не находится в БКНФ, так как имеется детерминант (<span>Цп</span>), не являющийся возможным ключом. Это является причиной следующих недостатков:<o:p></o:p></span></p> <p><i><span>избыточность данных</span></i><span>: некоторые данные хранятся многократно. Например, данные о том, какая деталь выпускается Цп, хранятся несколько раз (столько, сколько имеется Цз, получающих у Цп данную деталь). Так, информация о том, что цех Ц10 выпускает планки, приведена в таблице на рис. 8 дважды;<o:p></o:p></span></p> <p><i><span>аномалия добавления (ввода)</span></i><span>: невозможность ввода данных о Цп, пока он не начал выпуск какой-либо детали;<o:p></o:p></span></p> <p><i><span>аномалия удаления</span></i><span>: например, если цех Ц22 прекратит получать гайки от цеха Ц17, то информация о цехе Ц17 будет потеряна;<o:p></o:p></span></p> <p><i><span>аномалия обновления</span></i><span>: если Цп перейдет на выпуск другой детали, то потребуется вносить изменения в несколько записей. Кроме того, при этом в некоторый момент времени одному Цп будут соответствовать разные детали.<o:p></o:p></span></p> <p><span>Чтобы привести таблицу к БКНФ, требуется выделить детерминант, не являющийся возможным ключом, и атрибут, находящийся в функциональной зависимости от него, в отдельную таблицу. <o:p></o:p></span></p> <p><span>В рассматриваемом примере таблица на рис. 8 не находится в БКНФ из-за функциональной зависимости <span>Цп </span>→ <span>Деталь</span>. Значит, требуется выделить их в отдельную таблицу (рис. 9). <o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>Деталь<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Цех-поставщик<o:p></o:p></span></p> </td> </tr> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>планка<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц10<o:p></o:p></span></p> </td> </tr> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>гайка<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц12<o:p></o:p></span></p> </td> </tr> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>этикетка<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц15<o:p></o:p></span></p> </td> </tr> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>гайка<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц17<o:p></o:p></span></p> </td> </tr> <tr> <td width="104" valign="top"> <p style="text-align: center;"><span>штепсель<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц11<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: center;"><span>Рис. 9.<span> </span>Таблица «Цехи-поставщики»<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Атрибут <span>Цп</span> в этой таблице является ключом. Еще одна таблица будет содержать все атрибуты, кроме атрибута <span>Деталь</span> (рис. 10). <o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Цех-заказчик<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Цех-поставщик<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц10<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц12<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц21<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц15<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц22<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц17<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц22<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц11<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц23<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц10<o:p></o:p></span></p> </td> </tr> <tr> <td width="123" valign="top"> <p style="text-align: center;"><span>Ц23<o:p></o:p></span></p> </td> <td width="142" valign="top"> <p style="text-align: center;"><span>Ц11<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: center;"><span>Рис. 10.<span> </span>Таблица «Поставки»<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Таким образом, БД о внутренних поставках деталей, приведенная к БКНФ, будет состоять из двух таблиц, показанных на рис. 9 и 10.<o:p></o:p></span></p> <p><span>В таблицах отсутствуют недостатки, указанные выше. Таким образом, проектирование БД о поставках деталей внутри предприятия завершено.<o:p></o:p></span></p> <p><span>Примечание. Как было показано выше, в данном примере имелось два возможных ключа. (<span>Цз, Деталь</span>) и (<span>Цз, Цп</span>). В рассматриваемом примере в качестве ключа использовалась комбинация атрибутов (<span>Цз, Деталь</span>). Если бы в качестве ключа была выбрана комбинация (<span>Цз, Цп</span>), то потребовалось бы приведение таблицы к 2НФ из-за наличия неполной функциональной зависимости: атрибут <span>Деталь</span> зависел бы от части ключа <span>Цп</span>. Результатом приведения к 2НФ были бы таблицы, показанные на рис. 9 и 10.<o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p style="text-align: center;"><a></a><a><span><b><span>12.5.5 Четвертая нормальная форма</span></b></span></a><span><b><span><o:p></o:p></span></b></span></p> <span></span> <p><span> <o:p></o:p></span></p> <p><span>Еще одной достаточно редкой причиной аномалий отношений могут быть многозначные зависимости. Атрибут </span><span>A</span><span> </span><span>многозначно определяет атрибут </span><span>B</span><span> (обозначается как </span><span>A</span><span> —>> </span><span>B</span><span>), если одному значению атрибута </span><span>A</span><span> всегда соответствует определенный набор значений атрибута </span><span>B</span><span>. Аномалии возникают, если в одной таблице имеется несколько многозначных зависимостей.<o:p></o:p></span></p> <p><span>Пример. Разрабатывается БД о преподавателях вуза. Пусть требуется хранить в БД следующие данные о каждом преподавателе: табельный номер; фамилия; преподаваемые курсы; иностранные языки, которыми владеет преподаватель.<o:p></o:p></span></p> <p><span>На рис. 11 приведен фрагмент БД с данными об одном преподавателе (табельный номер – 115, фамилия – Иванов, преподает курсы “Теория вероятностей”, “Численные методы” и “Дискретная математика”, знает английский и французский языки).<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span> <o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" width="677" style="margin:0 auto;"> <tr> <td width="159" valign="top"> <p><span>Табельный номер<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Фамилия<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Преподаваемый курс<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>Иностранный язык<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Теория вероятностей<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Численные методы<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Дискретная математика<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Теория вероятностей<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>французский<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Численные методы<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>французский<o:p></o:p></span></p> </td> </tr> <tr> <td width="159" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p><span>Дискретная математика<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p><span>французский<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: center;"><span>Рис. 11.<span> </span>БД о преподавателях вуза<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span>Таблица на рис. 11 приведена к 1НФ. Она явно имеет недостатки, например, очень большую избыточность. Однако легко убедиться, что по-другому привести таблицу к 1НФ (т.е. обеспечить, чтобы в каждом поле таблицы содержалось одно значение) невозможно.<o:p></o:p></span></p> <p><span>Ключ в таблице – комбинация атрибутов (Табельный номер, Преподаваемый курс, Иностранный язык). Таблица не находится в 2НФ, так как атрибут Фамилия зависит от части ключа (от табельного номера). Результатом приведения к 2НФ являются таблицы на рис. 12.<o:p></o:p></span></p> <p style="text-align: right;"><span> Таблица «Фамилии»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p style="text-align: center;"><span>Фамилия<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p style="text-align: center;"><span>Иванов<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span><o:p> </o:p></span></p> <p style="text-align: right;"><span>Таблица «Сведения о преподавателях»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Преподаваемый курс<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>Иностранный язык<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Теория вероятностей<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Численные методы<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Дискретная математика<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Теория вероятностей<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>французский<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Численные методы<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>французский<o:p></o:p></span></p> </td> </tr> <tr> <td width="187" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="253" valign="top"> <p style="text-align: center;"><span>Дискретная математика<o:p></o:p></span></p> </td> <td width="198" valign="top"> <p style="text-align: center;"><span>французский<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> Рис. 12.<span> </span>Таблицы «Фамилии» и<span> </span>«Сведения о преподавателях» <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span>Эти таблицы находятся в 2НФ, 3НФ и БКНФ. Однако очевидно, что таблица «Сведения о преподавателях» имеет ряд взаимосвязанных недостатков:<o:p></o:p></span></p> <p><i><span>избыточность данных</span></i><span>: информация о преподаваемых курсах и иностранных языках хранится многократно. Если преподаватель преподает </span><span>M</span><span> курсов и знает </span><span>N</span><span> иностранных языков, то для хранения данных об этом требуется </span><span>M</span><span><span>×</span></span><span>N</span><span> записей;<o:p></o:p></span></p> <p><i><span>аномалия добавления (ввода)</span></i><span>: например, если преподаватель, знающий </span><span>N</span><span> языков, начнет преподавать новый курс, то потребуется добавить </span><span>N</span><span> строк;<o:p></o:p></span></p> <p><i><span>аномалия удаления</span></i><span>: если преподаватель, знающий </span><span>N</span><span> языков, перестанет преподавать некоторый курс, то потребуется удалить </span><span>N</span><span> строк;<o:p></o:p></span></p> <p><i><span>аномалия обновления</span></i><span>: если изменится название курса, то его потребуется изменять </span><span>N</span><span> раз, и в течение некоторого времени один и тот же курс в таблице будет называться по-разному.<o:p></o:p></span></p> <p><span>Причина этих недостатков – наличие в таблице «Сведения о преподавателях» двух многозначных зависимостей:<o:p></o:p></span></p> <p><i><span>Табельный номер</span></i><span> —>> <i>Преподаваемый курс</i>, <o:p></o:p></span></p> <p><i><span>Табельный номер</span></i><span> —>> <i>Иностранный язык</i>.<o:p></o:p></span></p> <p><span>Таблица находится <b>в четвертой нормальной форме</b> (4НФ), если она находится в БКНФ и содержит не более одной многозначной зависимости.<o:p></o:p></span></p> <p><span>Если таблица содержит несколько многозначных зависимостей (</span><span>A</span><span> —>> </span><span>B</span><span>), то требуется выделить каждую из них в отдельную таблицу. В рассматриваемом примере для этого требуется выделить в отдельные таблицы выявленные многозначные зависимости. <o:p></o:p></span></p> <p><span>Результат представлен на рис. 13.<o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица «Преподаваемые курсы»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Преподаваемый курс<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Теория вероятностей<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Численные методы<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Дискретная математика<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span> <o:p></o:p></span></p> <p style="text-align: right;"><span>Таблица<span> </span>«Знание языков»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>Иностранный язык<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>французский<o:p></o:p></span></p> </td> </tr> </table> </div> <p><span>Рис. 13.<span> </span>Результат разбиения таблицы «Сведения о преподавателях» <o:p></o:p></span></p> <p><span> <o:p></o:p></span></p> <p><span>Таким образом, в примере БД о преподавателях вуза, приведенная к 4НФ, состоит из трех таблиц, показанных на рис. 14.<o:p></o:p></span></p> <p style="text-align: right;"><span> Таблица «Фамилии»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="164" valign="top"> <p><span>Табельный номер<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Фамилия<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p><span>115<o:p></o:p></span></p> </td> <td width="117" valign="top"> <p><span>Иванов<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: right;"><span>Таблица «Преподаваемые курсы»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Преподаваемый курс<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Теория вероятностей<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Численные методы<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="225" valign="top"> <p style="text-align: center;"><span>Дискретная математика<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: right;"><span> Таблица<span> </span>«Знание языков»<o:p></o:p></span></p> <div style="text-align: center;"> <table border="1" cellspacing="0" cellpadding="0" style="margin:0 auto;"> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>Табельный номер<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>Иностранный язык<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>английский<o:p></o:p></span></p> </td> </tr> <tr> <td width="164" valign="top"> <p style="text-align: center;"><span>115<o:p></o:p></span></p> </td> <td width="175" valign="top"> <p style="text-align: center;"><span>французский<o:p></o:p></span></p> </td> </tr> </table> </div> <p style="text-align: center;"><span>Рис. 14.<span> </span>Результирующая БД, приведенная к 4НФ<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <p><span><o:p> </o:p></span></p> <h3 style="text-align: center;"><a></a><a></a><a><span><span><span>12.6 Подходы к проектированию БД</span></span></span></a><span><span><span><o:p></o:p></span></span></span></h3> <h3><span><span><o:p> </o:p></span></span></h3> <p><span><span><span>Решение задач логического проектирования БД в основном определяется спецификой задач предметной области. Наиболее важной здесь является про­блема структуризации данных, на ней мы сосредоточим основное внимание.</span></span></span></p> <p><span><span><span>При проектировании структур данных для автоматизированных систем можно выделить три основных подхода:</span></span></span></p> <p><span><span><span>1. Сбор информации об объектах решаемой задачи в рамках одной табли­цы (одного отношения) и последующая декомпозиция ее на несколько взаи­мосвязанных таблиц на основе процедуры нормализации отношений.</span></span></span></p> <p><span><span><span>2. Формулирование знаний о системе (определение типов исходных данных и их взаимосвязей) и требований к обработке данных, получение с помощью </span></span></span><span><span><span>CASE</span></span></span><span><span><span>-системы (системы автоматизации проектирования и разработки баз данных) готовой схемы БД или даже готовой прикладной информационной системы.</span></span></span></p> <p><span><span><span>3. Структурирование информации для использования в информационной системе в процессе проведения системного анализа на основе совокупности правил и рекомендаций.</span></span></span></p> <p><span><span><span>При построении<span> </span>логических схем и подсхем БД часто возникают трудности из-за проблем определения структур данных в отношениях реляционной модели. <o:p></o:p></span></span></span></p> <p><span><span><o:p> </o:p></span></span></p> <p style="text-align: center;"><span><span><b><span>12.7 Рекомендации по разработке структур </span></b></span></span><span><b><span>4.данных</span></b></span><b><span><o:p></o:p></span></b></p> <p><b><span><o:p> </o:p></span></b></p> <p><span>В качестве обобщения материала приведем наиболее <span>важные рекомендации, не учет которых может привести к аномалиям при обра</span>ботке данных в базах. Остановимся на двух вопросах: <o:p></o:p></span></p> <p><![if !supportLists]><span><span>1.<span> </span></span></span><![endif]><span>исходя из каких соображе<span>ний нужно создавать отношения (таблицы),</span><o:p></o:p></span></p> <p><![if !supportLists]><span><span>2.<span> </span></span></span><![endif]><span>каким образом следует их связывать.</span><span><o:p></o:p></span></p> <p><i><span>Основное правило </span></i><span>при создании таблиц сущностей - это «каждой сущнос</span><span>ти - отдельную таблицу»<span>.</span><o:p></o:p></span></p> <p><span>Поля таблиц сущностей могут быть двух видов: <i>ключевые </i>и <i>неключевые. </i>Введение ключей в таблице практически во всех реляционных СУБД позволяет обеспечить уникальность значений в записях таблицы по ключу, уско</span><span>рить обработку записей таблицы, а также выполнить автоматическую сорти</span><span>ровку записей по значениям в ключевых полях.</span><span><o:p></o:p></span></p> <p><span>Обычно достаточно определения <i>простого </i>ключа, реже - вводят <i>составной </i>ключ. </span><span>В некоторых СУБД пользователям предлагается определить автомати</span><span>чески создаваемое ключевое поле нумерации (в </span><span>Access</span><span> - это поле типа «счет</span><span>чик»), которое упрощает решение проблемы уникальности записей таблицы.</span><span><o:p></o:p></span></p> <p><span>Иногда в таблицах сущностей имеются поля описания свойств или характерис</span><span>тик объектов. Если в таблице есть значительное число повторений по этим полям и </span><span>эта информация имеет существенный объем, то лучше их выделить в отдельную таблицу (придерживаясь правила: «каждой сущности - отдельную таблицу»). Тем </span><span>более, следует образовать дополнительную таблицу, если свойства взаимосвязаны.</span><span><o:p></o:p></span></p> <p><span>В более общем виде, последние рекомендации можно сформулировать так: информацию о сущностях следует представить таким образом, чтобы неклю</span><span>чевые поля в таблицах были взаимно независимыми и полностью зависели <span>от ключа (см. определение 3НФ).</span><o:p></o:p></span></p> <p><span>В процессе обработки таблиц сущностей надо иметь в виду следующее. Новую </span><span>сущность легко добавить и изменить, но при удалении следует уничтожить все </span><span>ссылки на нее из таблиц связей, иначе таблицы связей будут некорректными. Многие современные СУБД блокируют некорректные действия в подобных операциях.</span><span><o:p></o:p></span></p> <p><span>Записи таблицы связей<i> </i>предназначены для отображения связей между </span><span>сущностями, информация о которых находится в соответствующих табли<span>цах сущностей. </span><span>Обычно одна таблица связей описывает взаимосвязь двух сущностей. Поскольку таблицы сущностей в простейшем случае имеют по одному ключе</span><span>вому полю, то таблица связей двух таблиц для обеспечения уникальности записей о связях должна иметь два ключа. Можно создать таблицу связей, как и таблицу сущностей (объектов), и без ключей, но тогда функции контроля за уникальностью записей ложатся на пользователя.</span><o:p></o:p></span></p> <p><span>Более сложные связи (не бинарные) следует сводить к бинарным. Для описания взаимосвязей </span><span>N</span><span> объектов требуется </span><span>N</span><span>-1 таблиц связей. Транзитивных связей не должно быть. Избыток связей приводит к противоречиям.</span><span><o:p></o:p></span></p> <p><span>Не следует включать в таблицы связей характеристики сущностей, иначе неизбежны аномалии. Их лучше хранить в отдельных таблицах </span><span>сущностей.</span><span><o:p></o:p></span></p> <p><span>С помощью таблиц связей можно описывать несколько специфический вид связи – линейную связь, или слабую связь. Примером линейной связи можно считать отношение принадлежности сущностей некоторой другой сущности более высокого порядка (системы, состоящие из узлов; лекарства, состоящие из компонентов; сплавы металлов и т.д.). В этом случае для описания связей достаточно одной таблицы связей.</span><span><o:p></o:p></span></p> <p><span>При работе с <span>таблицами связей следует иметь в виду, что любая запись из таблицы связей легко может быть удалена, поскольку сущности некоторое время могут обойтись без связей. При добавлении или изменении содержимого записей таблицы надо контролировать правильность ссылок на существующие объекты, так как связь без объектов существовать не может. Большинство современных СУБД контролирует правильность ссылок на объекты.<o:p></o:p></span></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><b><span>12.7.1 Свойства отношений<o:p></o:p></span></b></p> <p style="text-align: center;"><b><span><o:p> </o:p></span></b></p> <p><span>− Отношение имеет имя, которое отличается от имен всех других<o:p></o:p></span></p> <p><span>отношений<o:p></o:p></span></p> <p><span>− Каждая ячейка отношения содержит только атомарное (неделимое)<o:p></o:p></span></p> <p><span>значение<o:p></o:p></span></p> <p><span>− Каждый атрибут имеет уникальное имя<o:p></o:p></span></p> <p><span>− Значения атрибута берутся из одного и того же домена<o:p></o:p></span></p> <p><span>− Порядок следования атрибутов не имеет никакого значения<o:p></o:p></span></p> <p><span>− Каждый кортеж является уникальным, т. е. дубликатов кортежей быть не должно. В реляционных СУБД для таблиц предусматриваются специальные поля, называемые первичными ключами (primary key), значения которых не могут быть одинаковыми для разных кортежей, т.е. для ключевого столбца предусматривается соблюдение уникальности на значения.<o:p></o:p></span></p> <p><span>Теоретически порядок следования кортежей в отношении не имеет никакого значения, однако практически этот порядок может существенно повлиять на эффективность доступа к ним. Для устранения этого недостатка разработчики СУБД предусматривают возможность индексации полей, причем ключевые поля индексируются по умолчанию.<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p style="text-align: center;"><b><span>12.7.2 Реляционная целостность<o:p></o:p></span></b></p> <p style="text-align: center;"><b><span><o:p> </o:p></span></b></p> <p><span>Рассмотренные выше свойства отношений отражают структурную часть реляционной модели данных. Однако как уже указывалось модель данных имеет также и управляющую часть, которая определяет типы допустимых операций с данными, а также набор ограничений целостности , которые гарантируют корректность данных.<o:p></o:p></span></p> <p><span>Поскольку каждый атрибут связан с некоторым доменом, для множества допустимых значений каждого атрибута отношения определяются так называемые ограничения домена. Помимо этого задаются два важных правила целостности, которые, по сути, являются ограничениям для всех допустимых состояний базы данных. Эти два основных правила реляционной модели называются целостностью сущностей и ссылочной целостностью.<o:p></o:p></span></p> <p><span>ЦЕЛОСТНОСТЬ СУЩНОСТЕЙ. Первое ограничение целостности накладывает ограничения на значения первичных ключей базовых отношений, так что в базовом отношении ни один атрибут первичного ключа не может содержать отсутствующих значений, обозначаемых определителем NULL.<o:p></o:p></span></p> <p><span>Определитель NULL − указывает, что значение атрибута в настоящий момент неизвестно. Определитель NULL следует воспринимать как логическую величину “неизвестно” (никакое значение еще не задано). Определитель NULL не следует понимать как нулевое численное значение или заполненную пробелами текстовую строку. Нули и пробелы представляют собой некоторые значения, тогда как ключевое слово NULL призвано обозначать отсутствие какого−либо значения. Следовательно, определитель NULL следует рассматривать иначе, не так, как другие значения. По определению, первичный ключ − это уникальный идентификатор кортежей отношения. Это значит, что никакое подмножество ключа не может быть достаточным для уникальной идентификации кортежей. Если допустить присутствие значения NULL в любой части первичного ключа, это равноценно утверждению, что не все его атрибуты необходимы для идентификации, что противоречит определению.<o:p></o:p></span></p> <p><span>ССЫЛОЧНАЯ ЦЕЛОСТНОСТЬ. Второе ограничение целостности касается внешних ключей. Внешний ключ (foreign key) − Это атрибут или множество атрибутов внутри отношения, которое соответствует первичному ключу некоторого отношения. Если некий атрибут присутствует в нескольких отношениях, то его наличие обычно отражает определенную связь между кортежами этих отношений. В этом случае один из ключевых атрибутов первичен (для таблицы предка), второй − внешний, связующий.<o:p></o:p></span></p> <p><span>Ограничение ссылочной целостности гласит, что если в отношении существует внешний ключ, то значение внешнего ключа должно либо соответствовать значению первичного ключа некоторого кортежа в его базовом отношении, либо задаваться определителем NULL.<o:p></o:p></span></p> <p><span>КОРПОРАТИВНЫЕ ОГРАНИЧЕНИЯ ЦЕЛОСТНОСТИ. Корпоративные ограничения целостности − дополнительные правила поддержки целостности данных, определяемые пользователями или администраторами базы данных. Например, если в одном отделении предприятия не может работать свыше 20 человек, то пользователь может указать это правило, а СУБД следить за его исполнением.<o:p></o:p></span></p> <p><span><o:p> </o:p></span></p> <p><b><span><o:p> </o:p></span></b></p> </div>
 <A HREF="../theory.htm">Оглавление</A>               
 <p>&nbsp;</p>
        </table>
<table width="100%" height=25px border="0" cellpadding="0" cellspacing="3" bordercolor="#316AC5" background="../Оболочка/images/background.jpg">
  <tr >
  <td align=center><var><B><b>(С)  БГУИР</b></var></td>
  </tr>
</table>
</BODY></HTML>